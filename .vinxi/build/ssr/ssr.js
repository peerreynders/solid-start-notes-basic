import{isServer as S,getRequestEvent as L,createComponent as p,delegateEvents as sn,spread as Ye,useAssets as dt,ssr as E,escape as g,ssrHydrationKey as T,ssrAttribute as R,NoHydration as pe,ssrElement as Ee,mergeProps as an,HydrationScript as cn,Hydration as ln,renderToStream as un}from"solid-js/web";import{getOwner as J,runWithOwner as ft,createMemo as I,createContext as me,useContext as Q,untrack as ue,createSignal as A,createRenderEffect as ht,on as pt,startTransition as z,resetErrorBoundaries as Xe,createComponent as mt,children as gt,mergeProps as $e,createRoot as dn,Show as U,onCleanup as H,getListener as fn,sharedConfig as C,createResource as hn,createUniqueId as He,onMount as qe,For as pn,lazy as mn,Suspense as Ge,ErrorBoundary as gn}from"solid-js";import{createStore as wn,reconcile as yn}from"solid-js/store";import{provideRequestEvent as wt}from"solid-js/web/storage";import{H3Event as Ne,setResponseStatus as vn,sendRedirect as bn,getCookie as Sn,setCookie as En,setHeader as Rn,getRequestIP as Tn,getResponseStatus as $n,getResponseStatusText as Nn,getRequestURL as An,getResponseHeaders as xn,getResponseHeader as _n,setResponseHeader as Cn,appendResponseHeader as In,removeResponseHeader as Ln,getRequestWebStream as Pn,eventHandler as On}from"h3";import{AsyncLocalStorage as kn}from"node:async_hooks";import{createStorage as Dn}from"unstorage";import Fn from"unstorage/drivers/fs-lite";import{Observable as X,operate as yt,rx as Me}from"rxjs";import{nanoid as vt}from"nanoid";import{marked as Hn}from"marked";import qn from"sanitize-html";function bt(){let e=new Set;function n(o){return e.add(o),()=>e.delete(o)}let t=!1;function r(o,s){if(t)return!(t=!1);const a={to:o,options:s,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const i of e)i.listener({...a,from:i.location,retry:l=>{l&&(t=!0),i.navigate(o,{...s,resolve:!1})}});return!a.defaultPrevented}return{subscribe:n,confirm:r}}let Ae;function je(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Ae=window.history.state._depth}S||je();function Mn(e){return{...e,_depth:window.history.state&&window.history.state._depth}}function jn(e,n){let t=!1;return()=>{const r=Ae;je();const o=r==null?null:Ae-r;if(t){t=!1;return}o&&n(o)?(t=!0,window.history.go(-o)):e()}}const Bn=/^(?:[a-z0-9]+:)?\/\//i,Un=/^\/+|(\/)\/+$/g,Be="http://sr";function Y(e,n=!1){const t=e.replace(Un,"$1");return t?n||/^[?#]/.test(t)?t:"/"+t:""}function ce(e,n,t){if(Bn.test(n))return;const r=Y(e),o=t&&Y(t);let s="";return!o||n.startsWith("/")?s=r:o.toLowerCase().indexOf(r.toLowerCase())!==0?s=r+o:s=o,(s||"/")+Y(n,!s)}function Wn(e,n){if(e==null)throw new Error(n);return e}function Kn(e,n){return Y(e).replace(/\/*(\*.*)?$/g,"")+Y(n)}function Ue(e){const n={};return e.searchParams.forEach((t,r)=>{n[r]=t}),n}function zn(e,n,t){const[r,o]=e.split("/*",2),s=r.split("/").filter(Boolean),a=s.length;return i=>{const l=i.split("/").filter(Boolean),u=l.length-a;if(u<0||u>0&&o===void 0&&!n)return null;const c={path:a?"":"/",params:{}},h=m=>t===void 0?void 0:t[m];for(let m=0;m<a;m++){const y=s[m],d=l[m],f=y[0]===":",w=f?y.slice(1):y;if(f&&Re(d,h(w)))c.params[w]=d;else if(f||!Re(d,y))return null;c.path+=`/${d}`}if(o){const m=u?l.slice(-u).join("/"):"";if(Re(m,h(o)))c.params[o]=m;else return null}return c}}function Re(e,n){const t=r=>r.localeCompare(e,void 0,{sensitivity:"base"})===0;return n===void 0?!0:typeof n=="string"?t(n):typeof n=="function"?n(e):Array.isArray(n)?n.some(t):n instanceof RegExp?n.test(e):!1}function Yn(e){const[n,t]=e.pattern.split("/*",2),r=n.split("/").filter(Boolean);return r.reduce((o,s)=>o+(s.startsWith(":")?2:3),r.length-(t===void 0?0:1))}function St(e){const n=new Map,t=J();return new Proxy({},{get(r,o){return n.has(o)||ft(t,()=>n.set(o,I(()=>e()[o]))),n.get(o)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(e())}})}function Xn(e,n){const t=new URLSearchParams(e);Object.entries(n).forEach(([o,s])=>{s==null||s===""?t.delete(o):t.set(o,String(s))});const r=t.toString();return r?`?${r}`:""}function Et(e){let n=/(\/?\:[^\/]+)\?/.exec(e);if(!n)return[e];let t=e.slice(0,n.index),r=e.slice(n.index+n[0].length);const o=[t,t+=n[1]];for(;n=/^(\/\:[^\/]+)\?/.exec(r);)o.push(t+=n[1]),r=r.slice(n[0].length);return Et(r).reduce((s,a)=>[...s,...o.map(i=>i+a)],[])}const Gn=100,Rt=me(),ge=me(),we=()=>Wn(Q(Rt),"Make sure your app is wrapped in a <Router />"),Vn=()=>Q(ge)||we().base,Z=()=>we().navigatorFactory(),ye=()=>we().location,Jn=()=>we().isRouting,Qn=()=>Vn().params,Tt=()=>{const e=ye(),n=Z(),t=(r,o)=>{const s=ue(()=>e.pathname+Xn(e.search,r)+e.hash);n(s,{scroll:!1,resolve:!1,...o})};return[e.query,t]};function Zn(e,n=""){const{component:t,load:r,children:o,info:s}=e,a=!o||Array.isArray(o)&&!o.length,i={key:e,component:t,load:r,info:s};return $t(e.path).reduce((l,u)=>{for(const c of Et(u)){const h=Kn(n,c);let m=a?h:h.split("/*",1)[0];m=m.split("/").map(y=>y.startsWith(":")||y.startsWith("*")?y:encodeURIComponent(y)).join("/"),l.push({...i,originalPath:c,pattern:m,matcher:zn(m,!a,e.matchFilters)})}return l},[])}function er(e,n=0){return{routes:e,score:Yn(e[e.length-1])*1e4-n,matcher(t){const r=[];for(let o=e.length-1;o>=0;o--){const s=e[o],a=s.matcher(t);if(!a)return null;r.unshift({...a,route:s})}return r}}}function $t(e){return Array.isArray(e)?e:[e]}function Nt(e,n="",t=[],r=[]){const o=$t(e);for(let s=0,a=o.length;s<a;s++){const i=o[s];if(i&&typeof i=="object"){i.hasOwnProperty("path")||(i.path="");const l=Zn(i,n);for(const u of l){t.push(u);const c=Array.isArray(i.children)&&i.children.length===0;if(i.children&&!c)Nt(i.children,u.pattern,t,r);else{const h=er([...t],r.length);r.push(h)}t.pop()}}}return t.length?r:r.sort((s,a)=>a.score-s.score)}function de(e,n){for(let t=0,r=e.length;t<r;t++){const o=e[t].matcher(n);if(o)return o}return[]}function tr(e,n){const t=new URL(Be),r=I(l=>{const u=e();try{return new URL(u,t)}catch{return console.error(`Invalid path ${u}`),l}},t,{equals:(l,u)=>l.href===u.href}),o=I(()=>r().pathname),s=I(()=>r().search,!0),a=I(()=>r().hash),i=()=>"";return{get pathname(){return o()},get search(){return s()},get hash(){return a()},get state(){return n()},get key(){return i()},query:St(pt(s,()=>Ue(r())))}}let O;function nr(){return O}function rr(e,n,t,r={}){const{signal:[o,s],utils:a={}}=e,i=a.parsePath||(v=>v),l=a.renderPath||(v=>v),u=a.beforeLeave||bt(),c=ce("",r.base||"");if(c===void 0)throw new Error(`${c} is not a valid base path`);c&&!o().value&&s({value:c,replace:!0,scroll:!1});const[h,m]=A(!1),y=async v=>{m(!0);try{await z(v)}finally{m(!1)}},[d,f]=A(o().value),[w,b]=A(o().state),q=tr(d,w),_=[],k=A(S?on():[]),W={pattern:c,params:{},path:()=>c,outlet:()=>null,resolvePath(v){return ce(c,v)}};return ht(()=>{const{value:v,state:$}=o();ue(()=>{v!==d()&&y(()=>{O="native",f(v),b($),Xe(),k[1]([])}).then(()=>{O=void 0})})}),{base:W,location:q,isRouting:h,renderPath:l,parsePath:i,navigatorFactory:tn,beforeLeave:u,preloadRoute:rn,singleFlight:r.singleFlight===void 0?!0:r.singleFlight,submissions:k};function en(v,$,D){ue(()=>{if(typeof $=="number"){$&&(a.go?a.go($):console.warn("Router integration does not support relative routing"));return}const{replace:oe,resolve:Se,scroll:F,state:M}={replace:!1,resolve:!0,scroll:!0,...D},P=Se?v.resolvePath($):ce("",$);if(P===void 0)throw new Error(`Path '${$}' is not a routable path`);if(_.length>=Gn)throw new Error("Too many redirects");const ze=d();if(P!==ze||M!==w()){if(S){const se=L();se&&(se.response={status:302,headers:new Headers({Location:P})}),s({value:P,replace:oe,scroll:F,state:M})}else if(u.confirm(P,D)){const se=_.push({value:ze,replace:oe,scroll:F,state:w()});y(()=>{O="navigate",f(P),b(M),Xe(),k[1]([])}).then(()=>{_.length===se&&(O=void 0,nn({value:P,state:M}))})}}})}function tn(v){return v=v||Q(ge)||W,($,D)=>en(v,$,D)}function nn(v){const $=_[0];$&&((v.value!==$.value||v.state!==$.state)&&s({...v,replace:$.replace,scroll:$.scroll}),_.length=0)}function rn(v,$){const D=de(t(),v.pathname),oe=O;O="preload";for(let Se in D){const{route:F,params:M}=D[Se];F.component&&F.component.preload&&F.component.preload();const{load:P}=F;$&&P&&ft(n(),()=>P({params:M,location:{pathname:v.pathname,search:v.search,hash:v.hash,query:Ue(v),state:null,key:""},intent:"preload"}))}O=oe}function on(){const v=L();return v&&v.router&&v.router.submission?[v.router.submission]:[]}}function or(e,n,t,r,o){const{base:s,location:a}=e,{pattern:i,component:l,load:u}=r().route,c=I(()=>r().path);l&&l.preload&&l.preload();const h=u?u({params:o,location:a,intent:O||"initial"}):void 0;return{parent:n,pattern:i,path:c,params:o,outlet:()=>l?mt(l,{params:o,location:a,data:h,get children(){return t()}}):t(),resolvePath(y){return ce(s.path(),y,c())}}}const At=e=>n=>{const{base:t}=n,r=gt(()=>n.children),o=I(()=>Nt(n.root?{component:n.root,load:n.rootLoad,children:r()}:r(),n.base||""));let s;const a=rr(e,()=>s,o,{base:t,singleFlight:n.singleFlight});return e.create&&e.create(a),p(Rt.Provider,{value:a,get children(){return[(s=J())&&null,p(sr,{routerState:a,get branches(){return o()}})]}})};function sr(e){const n=I(()=>de(e.branches,e.routerState.location.pathname));if(S){const a=L();if(a&&a.router&&a.router.dataOnly){ir(a,e.branches);return}a&&((a.router||(a.router={})).matches||(a.router.matches=n().map(({route:i,path:l,params:u})=>({path:i.originalPath,pattern:i.pattern,match:l,params:u,info:i.info}))))}const t=St(()=>{const a=n(),i={};for(let l=0;l<a.length;l++)Object.assign(i,a[l].params);return i}),r=[];let o;const s=I(pt(n,(a,i,l)=>{let u=i&&a.length===i.length;const c=[];for(let h=0,m=a.length;h<m;h++){const y=i&&i[h],d=a[h];l&&y&&d.route.key===y.route.key?c[h]=l[h]:(u=!1,r[h]&&r[h](),dn(f=>{r[h]=f,c[h]=or(e.routerState,c[h-1]||e.routerState.base,ar(()=>s()[h+1]),()=>n()[h],t)}))}return r.splice(a.length).forEach(h=>h()),l&&u?l:(o=c[0],c)}));return p(U,{get when(){return s()&&o},keyed:!0,children:a=>p(ge.Provider,{value:a,get children(){return a.outlet()}})})}const ar=e=>()=>p(U,{get when(){return e()},keyed:!0,children:n=>p(ge.Provider,{value:n,get children(){return n.outlet()}})}),K=e=>{const n=gt(()=>e.children);return $e(e,{get children(){return n()}})};function ir(e,n){const t=new URL(e.request.url),r=de(n,new URL(e.router.previousUrl||e.request.url).pathname),o=de(n,t.pathname);for(let s=0;s<o.length;s++){(!r[s]||o[s].route!==r[s].route)&&(e.router.dataOnly=!0);const{route:a,params:i}=o[s];a.load&&a.load({params:i,location:{pathname:t.pathname,search:t.search,hash:t.hash,query:Ue(t),state:null,key:""},intent:"preload"})}}function cr([e,n],t,r){return[t?()=>t(e()):e,r?o=>n(r(o)):n]}function lr(e){if(e==="#")return null;try{return document.querySelector(e)}catch{return null}}function ur(e){let n=!1;const t=o=>typeof o=="string"?{value:o}:o,r=cr(A(t(e.get()),{equals:(o,s)=>o.value===s.value}),void 0,o=>(!n&&e.set(o),o));return e.init&&H(e.init((o=e.get())=>{n=!0,r[1](t(o)),n=!1})),At({signal:r,create:e.create,utils:e.utils})}function dr(e,n,t){return e.addEventListener(n,t),()=>e.removeEventListener(n,t)}function fr(e,n){const t=lr(`#${e}`);t?t.scrollIntoView():n&&window.scrollTo(0,0)}function hr(e){const n=new URL(e);return n.pathname+n.search}function pr(e){let n;const t={value:e.url||(n=L())&&hr(n.request.url)||""};return At({signal:[()=>t,r=>Object.assign(t,r)]})(e)}const mr="Location",gr=5e3,wr=18e4;let G=new Map;S||setInterval(()=>{const e=Date.now();for(let[n,t]of G.entries())!t[3].count&&e-t[0]>wr&&G.delete(n)},3e5);function We(){if(!S)return G;const e=L();if(!e)throw new Error("Cannot find cache context");return(e.router||(e.router={})).cache||(e.router.cache=new Map)}function xe(e,n=!0){return z(()=>{const t=Date.now();xt(e,r=>{n&&(r[0]=0),r[3][1](t)})})}function xt(e,n){e&&!Array.isArray(e)&&(e=[e]);for(let t of G.keys())(e===void 0||yr(t,e))&&n(G.get(t))}function ee(e,n){e.GET&&(e=e.GET);const t=(...r)=>{const o=We(),s=nr(),i=J()?Z():void 0,l=Date.now(),u=n+_e(r);let c=o.get(u),h;if(S){const d=L();if(d){const f=(d.router||(d.router={})).dataOnly;if(f){const w=d&&(d.router.data||(d.router.data={}));if(w&&u in w)return w[u];if(Array.isArray(f)&&!f.includes(u))return w[u]=void 0,Promise.resolve()}}}if(fn()&&!S&&(h=!0,H(()=>c[3].count--)),c&&(S||s==="native"||c[0]&&c[3].count||Date.now()-c[0]<gr)){h&&(c[3].count++,c[3][0]()),c[2]==="preload"&&s!=="preload"&&(c[0]=l);let d=c[1];return s!=="preload"&&(d="then"in c[1]?c[1].then(y(!1),y(!0)):y(!1)(c[1]),!S&&s==="navigate"&&z(()=>c[3][1](c[0]))),d}let m=!S&&C.context&&C.has(u)?C.load(u):e(...r);if(c?(c[0]=l,c[1]=m,c[2]=s,!S&&s==="navigate"&&z(()=>c[3][1](c[0]))):(o.set(u,c=[l,m,s,A(l)]),c[3].count=0),h&&(c[3].count++,c[3][0]()),S){const d=L();if(d&&d.router.dataOnly)return d.router.data[u]=m}if(s!=="preload"&&(m="then"in m?m.then(y(!1),y(!0)):y(!1)(m)),S&&C.context&&C.context.async&&!C.context.noHydrate){const d=L();(!d||!d.serverOnly)&&C.context.serialize(u,m)}return m;function y(d){return async f=>{if(f instanceof Response){if(f.headers.has("Location")){i&&z(()=>{let w=f.headers.get(mr);w&&w.startsWith("/")?i(w,{replace:!0}):!S&&w&&(window.location.href=w)});return}f.customBody&&(f=await f.customBody())}if(d)throw f;return f}}};return t.keyFor=(...r)=>n+_e(r),t.key=n,t}ee.set=(e,n)=>{const t=We(),r=Date.now();let o=t.get(e);o?(o[0]=r,o[1]=n,o[2]="preload"):(t.set(e,o=[r,n,,A(r)]),o[3].count=0)};ee.clear=()=>We().clear();function yr(e,n){for(let t of n)if(e.startsWith(t))return!0;return!1}function _e(e){return JSON.stringify(e,(n,t)=>vr(t)?Object.keys(t).sort().reduce((r,o)=>(r[o]=t[o],r),{}):t)}function vr(e){let n;return e!=null&&typeof e=="object"&&(!(n=Object.getPrototypeOf(e))||n===Object.prototype)}const Ce=new Map;function br(e,n){function t(...o){const s=this,a=(s.singleFlight&&e.withOptions?e.withOptions({headers:{"X-Single-Flight":"true"}}):e)(...o),[i,l]=A();let u;async function c(h){const m=await Er(h,s.navigatorFactory());return m?l({data:m}):u.clear(),m}return s.submissions[1](h=>[...h,u={input:o,url:r,get result(){return i()?.data},get pending(){return!i()},clear(){s.submissions[1](m=>m.filter(y=>y.input!==o))},retry(){return l(void 0),e(...o).then(c,c)}}]),a.then(c,c)}const r=e.url||n&&`https://action/${n}`||(S?"":`https://action/${Sr(e.toString())}`);return _t(t,r)}function _t(e,n){return e.toString=()=>{if(!n)throw new Error("Client Actions need explicit names if server rendered");return n},e.with=function(...t){const r=function(...s){return e.call(this,...t,...s)},o=new URL(n,Be);return o.searchParams.set("args",_e(t)),_t(r,(o.origin==="https://action"?o.origin:"")+o.pathname+o.search)},e.url=n,S||(Ce.set(n,e),J()&&H(()=>Ce.delete(n))),e}const Sr=e=>e.split("").reduce((n,t)=>(n<<5)-n+t.charCodeAt(0)|0,0);async function Er(e,n){let t,r,o;if(e instanceof Response){if(e.headers.has("X-Revalidate")&&(r=o=e.headers.get("X-Revalidate").split(",")),e.customBody&&(t=await e.customBody(),e.headers.has("X-Single-Flight")&&(r||(r=[]),o||(o=[]),Object.keys(t).forEach(s=>{s!=="_$value"&&(r.push(s),ee.set(s,t[s]))}),t=t._$value)),e.headers.has("Location")){const s=e.headers.get("Location")||"/";s.startsWith("http")?window.location.href=s:n(s)}}else t=e;return xt(o,s=>s[0]=0),await xe(r,!1),t}function Rr(e=!0,n=!1,t="/_server"){return r=>{const o=r.base.path(),s=r.navigatorFactory(r.base);let a={};function i(d){return d.namespaceURI==="http://www.w3.org/2000/svg"}function l(d){if(d.defaultPrevented||d.button!==0||d.metaKey||d.altKey||d.ctrlKey||d.shiftKey)return;const f=d.composedPath().find(W=>W instanceof Node&&W.nodeName.toUpperCase()==="A");if(!f||n&&!f.hasAttribute("link"))return;const w=i(f),b=w?f.href.baseVal:f.href;if((w?f.target.baseVal:f.target)||!b&&!f.hasAttribute("state"))return;const _=(f.getAttribute("rel")||"").split(/\s+/);if(f.hasAttribute("download")||_&&_.includes("external"))return;const k=w?new URL(b,document.baseURI):new URL(b);if(!(k.origin!==window.location.origin||o&&k.pathname&&!k.pathname.toLowerCase().startsWith(o.toLowerCase())))return[f,k]}function u(d){const f=l(d);if(!f)return;const[w,b]=f,q=r.parsePath(b.pathname+b.search+b.hash),_=w.getAttribute("state");d.preventDefault(),s(q,{resolve:!1,replace:w.hasAttribute("replace"),scroll:!w.hasAttribute("noscroll"),state:_&&JSON.parse(_)})}function c(d){const f=l(d);if(!f)return;const[w,b]=f;a[b.pathname]||r.preloadRoute(b,w.getAttribute("preload")!=="false")}function h(d){const f=l(d);if(!f)return;const[w,b]=f;a[b.pathname]||(a[b.pathname]=setTimeout(()=>{r.preloadRoute(b,w.getAttribute("preload")!=="false"),delete a[b.pathname]},200))}function m(d){const f=l(d);if(!f)return;const[,w]=f;a[w.pathname]&&(clearTimeout(a[w.pathname]),delete a[w.pathname])}function y(d){let f=d.submitter&&d.submitter.hasAttribute("formaction")?d.submitter.getAttribute("formaction"):d.target.getAttribute("action");if(!f)return;if(!f.startsWith("https://action/")){const b=new URL(f,Be);if(f=r.parsePath(b.pathname+b.search),!f.startsWith(t))return}if(d.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const w=Ce.get(f);if(w){d.preventDefault();const b=new FormData(d.target);d.submitter&&d.submitter.name&&b.append(d.submitter.name,d.submitter.value),w.call(r,b)}}sn(["click","submit"]),document.addEventListener("click",u),e&&(document.addEventListener("mouseover",h),document.addEventListener("mouseout",m),document.addEventListener("focusin",c),document.addEventListener("touchstart",c)),document.addEventListener("submit",y),H(()=>{document.removeEventListener("click",u),e&&(document.removeEventListener("mouseover",h),document.removeEventListener("mouseout",m),document.removeEventListener("focusin",c),document.removeEventListener("touchstart",c)),document.removeEventListener("submit",y)})}}function Tr(e){if(S)return pr(e);const n=()=>({value:window.location.pathname+window.location.search+window.location.hash,state:window.history.state}),t=bt();return ur({get:n,set({value:r,replace:o,scroll:s,state:a}){o?window.history.replaceState(Mn(a),"",r):window.history.pushState(a,"",r),fr(window.location.hash.slice(1),s),je()},init:r=>dr(window,"popstate",jn(r,o=>{if(o&&o<0)return!t.confirm(o);{const s=n();return!t.confirm(s.value,{state:s.state})}})),create:Rr(e.preload,e.explicitLinks,e.actionBase),utils:{go:r=>window.history.go(r),beforeLeave:t}})(e)}function Ct(e,n){let t,r=()=>!t||t.state==="unresolved"?void 0:t.latest;return[t]=hn(()=>$r(e,ue(r)),o=>o,n),()=>t()}class x{static all(){return new x}static allSettled(){return new x}static any(){return new x}static race(){return new x}static reject(){return new x}static resolve(){return new x}catch(){return new x}then(){return new x}finally(){return new x}}function $r(e,n){if(S||!C.context)return e(n);const t=fetch,r=Promise;try{return window.fetch=()=>new x,Promise=x,e(n)}finally{window.fetch=t,Promise=r}}function Ve(e,n=302){let t,r;typeof n=="number"?t={status:n}:({revalidate:r,...t}=n,typeof t.status>"u"&&(t.status=302));const o=new Headers(t.headers);return o.set("Location",e),r&&o.set("X-Revalidate",r.toString()),new Response(null,{...t,headers:o})}const It=me(),Lt=["title","meta"],Ie=[],Le=["name","http-equiv","content","charset","media"].concat(["property"]),fe=(e,n)=>{const t=Object.fromEntries(Object.entries(e.props).filter(([r])=>n.includes(r)).sort());return(Object.hasOwn(t,"name")||Object.hasOwn(t,"property"))&&(t.name=t.name||t.property,delete t.property),e.tag+JSON.stringify(t)};function Nr(){if(!C.context){const t=document.head.querySelectorAll("[data-sm]");Array.prototype.forEach.call(t,r=>r.parentNode.removeChild(r))}const e=new Map;function n(t){if(t.ref)return t.ref;let r=document.querySelector(`[data-sm="${t.id}"]`);return r?(r.tagName.toLowerCase()!==t.tag&&(r.parentNode&&r.parentNode.removeChild(r),r=document.createElement(t.tag)),r.removeAttribute("data-sm")):r=document.createElement(t.tag),r}return{addTag(t){if(Lt.indexOf(t.tag)!==-1){const s=t.tag==="title"?Ie:Le,a=fe(t,s);e.has(a)||e.set(a,[]);let i=e.get(a),l=i.length;i=[...i,t],e.set(a,i);let u=n(t);t.ref=u,Ye(u,t.props);let c=null;for(var r=l-1;r>=0;r--)if(i[r]!=null){c=i[r];break}return u.parentNode!=document.head&&document.head.appendChild(u),c&&c.ref&&document.head.removeChild(c.ref),l}let o=n(t);return t.ref=o,Ye(o,t.props),o.parentNode!=document.head&&document.head.appendChild(o),-1},removeTag(t,r){const o=t.tag==="title"?Ie:Le,s=fe(t,o);if(t.ref){const a=e.get(s);if(a){if(t.ref.parentNode){t.ref.parentNode.removeChild(t.ref);for(let i=r-1;i>=0;i--)a[i]!=null&&document.head.appendChild(a[i].ref)}a[r]=null,e.set(s,a)}else t.ref.parentNode&&t.ref.parentNode.removeChild(t.ref)}}}}function Ar(){const e=[];return dt(()=>E(Ir(e))),{addTag(n){if(Lt.indexOf(n.tag)!==-1){const t=n.tag==="title"?Ie:Le,r=fe(n,t),o=e.findIndex(s=>s.tag===n.tag&&fe(s,t)===r);o!==-1&&e.splice(o,1)}return e.push(n),e.length},removeTag(n,t){}}}const xr=e=>{const n=S?Ar():Nr();return p(It.Provider,{value:n,get children(){return e.children}})},_r=(e,n,t)=>(Cr({tag:e,props:n,setting:t,id:He(),get name(){return n.name||n.property}}),null);function Cr(e){const n=Q(It);if(!n)throw new Error("<MetaProvider /> should be in the tree");ht(()=>{const t=n.addTag(e);H(()=>n.removeTag(e,t))})}function Ir(e){return e.map(n=>{const r=Object.keys(n.props).map(s=>s==="children"?"":` ${s}="${g(n.props[s],!0)}"`).join(""),o=n.props.children;return n.setting?.close?`<${n.tag} data-sm="${n.id}"${r}>${n.setting?.escape?g(o):o||""}</${n.tag}>`:`<${n.tag} data-sm="${n.id}"${r}/>`}).join("")}const te=e=>_r("title",e,{escape:!0,close:!0});function Lr(e){const n="/notes/";let t=e.indexOf(n);if(t<0)return"";t+=n.length;const r=e.indexOf("/",t);return r<0?e.slice(t):e.slice(t,r)}const Pt="/",Pr="/new",Ot=e=>`/notes/${e}`,Or=e=>`/notes/${e}/edit`,kr=e=>e.search?e.pathname+e.search:e.pathname,Dr=e=>new URL(e,"thismessage:/").search??"",Je=(e="")=>Pt+e,Fr=(e,n="")=>Ot(e)+n;function Hr(e){const n=Lr(location.pathname);if(n.length<1)throw new Error("Pathname was expected to contain a note ID");return Or(n)+(e.search??"")}const qr=e=>Pt+(e.search??""),Mr=e=>Pr+(e.search??"");function jr(e,n){const t=Ot(n),r=e.search??"";return{pathname:t,search:r,href:t+r}}const Qe="SolidStart Notes",ne=e=>e?`${e} - ${Qe}`:Qe;var Br=["<button",">","</button>"];const Ur=e=>"c-edit-button"+(e==="new"?" js:c-edit-button--new":" js:c-edit-button--update");function kt(e){return ye(),Z(),e.kind,E(Br,T()+R("class",g(Ur(e.kind),!0),!1),g(e.children))}const Wr=(e,n)=>{if(S)return Object.assign(()=>{},{clear:()=>{}});let t;const r=()=>clearTimeout(t);return J()&&H(r),Object.assign((...s)=>{t!==void 0&&r(),t=setTimeout(()=>e(...s),n)},{clear:r})};var Kr=["<div",' role="progressbar"',"></div>"];function zr(e){return E(Kr,T()+R("class","c-spinner"+(e.active?" c-spinner--active":""),!1),R("aria-busy",g(e.active,!0),!1))}var Yr=["<form",' class="c-search-field" role="search"><label class="u-offscreen"',">Search for a note by title</label><input",' placeholder="Search"',"><!--$-->","<!--/--></form>"];function Xr(e){const n=Wr(e,250);return t=>{n({search:t.currentTarget.value}),t.preventDefault()}}function Gr(){const e=He(),n=Jn(),[t,r]=Tt();return Xr(r),E(Yr,T(),R("for",g(e,!0),!1),R("id",g(e,!0),!1),R("value",g(t.search,!0)??"",!1),g(p(zr,{get active(){return n()}})))}function Vr(e={}){let n,t=!1;const r=a=>{if(n&&n!==a)throw new Error("Context conflict")};let o;if(e.asyncContext){const a=e.AsyncLocalStorage||globalThis.AsyncLocalStorage;a?o=new a:console.warn("[unctx] `AsyncLocalStorage` is not provided.")}const s=()=>{if(o&&n===void 0){const a=o.getStore();if(a!==void 0)return a}return n};return{use:()=>{const a=s();if(a===void 0)throw new Error("Context is not available");return a},tryUse:()=>s(),set:(a,i)=>{i||r(a),n=a,t=!0},unset:()=>{n=void 0,t=!1},call:(a,i)=>{r(a),n=a;try{return o?o.run(a,i):i()}finally{t||(n=void 0)}},async callAsync(a,i){n=a;const l=()=>{n=a},u=()=>n===a?l:void 0;tt.add(u);try{const c=o?o.run(a,i):i();return t||(n=void 0),await c}finally{tt.delete(u)}}}}function Jr(e={}){const n={};return{get(t,r={}){return n[t]||(n[t]=Vr({...e,...r})),n[t],n[t]}}}const he=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:typeof window<"u"?window:{},Ze="__unctx__",Qr=he[Ze]||(he[Ze]=Jr()),Zr=(e,n={})=>Qr.get(e,n),et="__unctx_async_handlers__",tt=he[et]||(he[et]=new Set);function eo(e){let n;const t=Dt(e),r={duplex:"half",method:e.method,headers:e.headers};return e.node.req.body instanceof ArrayBuffer?new Request(t,{...r,body:e.node.req.body}):new Request(t,{...r,get body(){return n||(n=ho(e),n)}})}function to(e){return e.web??={request:eo(e),url:Dt(e)},e.web.request}function no(){return wo()}const V=Symbol("$HTTPEvent");function ro(e){return typeof e=="object"&&(e instanceof Ne||e?.[V]instanceof Ne||e?.__is_event__===!0)}function N(e){return function(...n){let t=n[0];if(ro(t))n[0]=t instanceof Ne||t.__is_event__?t:t[V];else{if(!globalThis.app.config.server.experimental?.asyncContext)throw new Error("AsyncLocalStorage was not enabled. Use the `server.experimental.asyncContext: true` option in your app configuration to enable it. Or, pass the instance of HTTPEvent that you have as the first argument to the function.");if(t=no(),!t)throw new Error("No HTTPEvent found in AsyncLocalStorage. Make sure you are using the function within the server runtime.");n.unshift(t)}return e(...n)}}const Dt=N(An),oo=N(Tn),Pe=N(vn),nt=N($n),so=N(Nn),ae=N(xn),rt=N(_n),ao=N(Cn),io=N(In),co=N(bn),lo=N(Sn),uo=N(En),fo=N(Rn),ho=N(Pn),po=N(Ln),mo=N(to);function go(){return Zr("nitro-app",{asyncContext:!!globalThis.app.config.server.experimental?.asyncContext,AsyncLocalStorage:kn})}function wo(){return go().use().event}const Te=Symbol("fetchEvent");function yo(e){return{request:mo(e),response:Eo(e),clientAddress:oo(e),locals:{},nativeEvent:e,[V]:e}}function vo(e){return{...e,[V]:e[V]}}function bo(e){if(!e[Te]){const n=yo(e);e[Te]=n}return e[Te]}class So{constructor(n){this.event=n}get(n){const t=rt(this.event,n);return Array.isArray(t)?t.join(", "):t}has(n){return this.get(n)!==void 0}set(n,t){return ao(this.event,n,t)}delete(n){return po(this.event,n)}append(n,t){io(this.event,n,t)}getSetCookie(){const n=rt(this.event,"Set-Cookie");return Array.isArray(n)?n:[n]}forEach(n){return Object.entries(ae(this.event)).forEach(([t,r])=>n(Array.isArray(r)?r.join(", "):r,t,this))}entries(){return Object.entries(ae(this.event)).map(([n,t])=>[n,Array.isArray(t)?t.join(", "):t])[Symbol.iterator]()}keys(){return Object.keys(ae(this.event))[Symbol.iterator]()}values(){return Object.values(ae(this.event)).map(n=>Array.isArray(n)?n.join(", "):n)[Symbol.iterator]()}[Symbol.iterator](){return this.entries()[Symbol.iterator]()}}function Eo(e){return{get status(){return nt(e)},set status(n){Pe(e,n)},get statusText(){return so(e)},set statusText(n){Pe(e,nt(),n)},headers:new So(e)}}function ve(e,n,t){if(typeof e!="function")throw new Error("Export from a 'use server' module must be a function");const r="";return new Proxy(e,{get(o,s,a){if(s==="url")return`${r}/_server/?id=${encodeURIComponent(n)}&name=${encodeURIComponent(t)}`;if(s==="GET")return a},apply(o,s,a){const i=L();if(!i)throw new Error("Cannot call server function outside of a request");const l=vo(i);return l.serverOnly=!0,wt(l,()=>e.apply(s,a))}})}const be=e=>({kind:"note-store",notes:e}),Ro=e=>({id:e.id,title:e.title,updatedAt:e.updatedAt,summary:e.excerpt}),To=e=>({id:e.id,title:e.title,body:e.body,createdAt:e.createdAt,updatedAt:e.updatedAt}),ot=20;function Ft(e){const n=Hn.parse(e,{async:!1}),r=qn(n,{allowedTags:[],allowedAttributes:{}}).trim().split(/\s+/),o=r.slice(0,ot).join(" ");return r.length>ot?o+"…":o}const j=[["Meeting Notes","This is an example note. It contains **Markdown**!"],["Make a thing",`It's very easy to make some words **bold** and other words *italic* with
Markdown. You can even [link to SolidStart's website!](https://start.solidjs.com/).`],["A note with a very long title because sometimes you need more words","You can write all kinds of [amazing](https://en.wikipedia.org/wiki/The_Amazing)\nnotes in this app! These notes live on the server in the `.data/notes` file.\n![This app is powered by SolidStart](https://assets.solidjs.com/banner?project=Start&amp;type=core)"],["I wrote this note today","It was an excellent note."]];function $o(e,n,t){const[r,o]=n<t?[n,t]:[t,n],s=o-r,a=l=>r+Math.floor(s*l/4294967295),i=new Uint32Array(e);return crypto.getRandomValues(i),i.sort(),Array.prototype.map.call(i,a)}function No(e){const n=new Date(e);return new Date(n.getFullYear(),0,1).getTime()}function Ao(e){const n=new X(r=>{let o;const s=[],a=Date.now(),i=$o(j.length,No(a),a),l=c=>{o||(o=c,r.error(o))},u=c=>{o||s.length>=j.length||(s.push(c),!(s.length<j.length)&&(r.next(s),r?.complete()))};for(let c=0;c<j.length;c+=1)e(j[c],Ft(j[c][1]),i[c],a,u,l);r.next(s),r?.complete()});return new X(r=>{n.subscribe(yt({destination:r,next:o=>void r.next(be(o)),complete:()=>void r.complete()}))})}const Ht=Dn({driver:Fn({base:".data"})}),qt=()=>Ht.getItem("notes");function xo(e,n){const t=n.updatedAt-e.updatedAt;return t!==0?t:n.createdAt-e.createdAt}const Mt=e=>new X(n=>{let t=!1;const r=i=>{t||(t=!0,n.error(i))};let o=!1,s=!1;const a=()=>{t||!(s&&o)||(t=!0,n.complete())};e.subscribe({error:r,next:i=>{const l=be(i.notes.toSorted(xo));Ht.setItem("notes",l.notes).then(()=>{n.next(l),o=!0,a()}).catch(r)},complete:()=>{s=!0,a()}})}),Ke=(e,n,t,r,o,s)=>({id:r,title:e,body:n,excerpt:t,createdAt:o,updatedAt:s});function _o([e,n],t,r,o,s,a){s(Ke(e,n,t,vt(),r,o))}const jt=e=>new X(n=>{let t=!1;const r=l=>{t||(t=!0,n.error(l))};let o=!1,s=!1;const a=()=>{t||!(s&&o)||(t=!0,n.complete())},i=()=>{o=!0,a()};e.subscribe({error:r,next:l=>{if(!t){if(l){n.next(be(l)),i();return}Me(Ao(_o),Mt).subscribe({error:r,next:u=>{t||n.next(u)},complete:i})}},complete:()=>{s=!0,a()}})});function Co(e,n){let t=!1,r=!1,o=!1;const s=()=>{t||!(r&&o)||(t=!0,n())};Me(qt(),jt).subscribe({error:a=>{t||(t=!0,e.reject(a),n())},next:a=>{if(!t){if(e.kind===0){const i=e.predicate?a.notes.filter(e.predicate):a.notes;e.resolve(i)}else e.resolve(a.notes.find(e.predicate));o=!0,s()}},complete:()=>{t||(r=!0,s())}})}function Io(e,n){let t=!1;const r=u=>{t||(t=!0,e.reject(u),n())};let o=!1,s=!1;const a=()=>{t||!(o&&s)||(t=!0,n())};let i;const l=u=>new X(c=>{let h=!1;const m=w=>{h||(h=!0,c.error(w))};let y=!1,d=!1;const f=()=>{h||!(y&&d)||(h=!0,c.complete())};u.subscribe(yt({destination:c,error:m,next:w=>{if(h)return;const[b,q]=e.update(w.notes);i=q,d=!0,c.next(be(b)),f()},complete:()=>{y=!0,f()}}))});Me(qt(),jt,l,Mt).subscribe({error:r,next:u=>{t||(s=!0,e.resolve(i),a())},complete:()=>{o=!0,a()}})}let Oe=!1,ie=-1;const le=[];function ke(){if(ie+=1,ie>=le.length){le.length=0,ie=-1,Oe=!1;return}const e=le[ie];switch(e.kind){case 0:case 1:{Co(e,ke);return}case 2:{Io(e,ke);return}}}function re(e){le.push(e),!Oe&&(Oe=!0,queueMicrotask(ke))}function Lo(e){if(!e)return;const n=e.toLowerCase();return t=>t.title.toLowerCase().includes(n)}function Po(e){const n=Lo(e);return new Promise((t,r)=>{re({kind:0,predicate:n,resolve:t,reject:r})})}function Oo(e){const n=t=>t.id===e;return new Promise((t,r)=>{re({kind:1,predicate:n,resolve:t,reject:r})})}const ko=e=>n=>{const t=Date.now(),r=Ke(e.title,e.body,e.excerpt,vt(),t,t);return[n.toSpliced(n.length,0,r),r]};function Do(e){return new Promise((n,t)=>{re({kind:2,update:ko(e),resolve:n,reject:t})})}const Fo=e=>n=>{const t=n.findIndex(s=>s.id===e.id);if(t<0)return[n,void 0];const r=n[t],o=Ke(e.title,e.body,e.excerpt,r.id,r.createdAt,Date.now());return[n.toSpliced(t,1,o),o]};function Ho(e){return new Promise((n,t)=>{re({kind:2,update:Fo(e),resolve:n,reject:t})})}const qo=e=>n=>{const t=n.findIndex(r=>r.id===e);return t>-1?[n.toSpliced(t,1),n[t]]:[n,void 0]};function Mo(e){return new Promise((n,t)=>{re({kind:2,update:qo(e),resolve:n,reject:t})})}const jo=e=>e.map(Ro),Bo=e=>Po(e).then(jo),Bt=e=>e?To(e):void 0,Uo=e=>Oo(e).then(Bt);function Wo(e,n,t){const r=Ft(n);return(typeof t=="string"&&t.length>0?Ho({id:t,title:e,body:n,excerpt:r}):Do({title:e,body:n,excerpt:r})).then(Bt)}const Ko=e=>Mo(e).then(n=>n?.id===e),zo=ve(Ko,"c_6666","deleteNote"),Yo=ve(Bo,"c_6666","getBriefs"),Xo=ve(Uo,"c_6666","getNote"),Go=ve(Wo,"c_6666","upsertNote"),Vo=["insert","update","delete"],Jo=e=>Vo.includes(e),Qo="edit-action",De="briefs",Zo="note",es=ee(async e=>Yo(e),De),ts=ee(async e=>Xo(e),Zo),ns=br(async e=>{const n=e.get("intent");if(typeof n!="string"||!Jo(n))throw new Error(`Malformed edit-action. "intent" param: :${n}`);const t=e.get("from");if(typeof t!="string"||t.length<1)throw new Error(`Malformed edit-action. "from" param: :${t}`);const r=Dr(t),o=e.get("id")??"",s=e.get("title")??"",a=e.get("body")??"";if(typeof o!="string"||typeof s!="string"||typeof a!="string")throw new Error("Malformed edit-action. note params");const i=o.length>0?o:void 0;if(n==="insert"||n==="update"){const l=await Go(s,a,i),u=l?Fr(l.id,r):Je(r);throw xe(De,!0),Ve(u)}if(n==="delete")throw i?(await zo(i),xe(De,!0),Ve(Je(r))):new Error("edit-action: cannot delete without ID")},Qo),Ut={locale:"en-GB",timeZone:"UTC",numberingSystem:"latn",calendar:"gregory",hour12:!1};function st({locale:e,timeZone:n,hour12:t}=Ut){const r=Intl.DateTimeFormat(e,{timeZone:n,hour12:t,dateStyle:"medium",timeStyle:"short"});return function(a){const i=new Date(a);return[r.format(i),i.toISOString()]}}function at({locale:e,timeZone:n,hour12:t}=Ut){const r=Intl.DateTimeFormat(e,{timeZone:n,hour12:t,dateStyle:"short"}),o=Intl.DateTimeFormat(e,{timeZone:n,hour12:t,timeStyle:"short"});let s=new Date;return function(l,u=!1){u&&(s=new Date);const c=new Date(l);return[c.getDate()===s.getDate()&&c.getMonth()===s.getMonth()&&c.getFullYear()===s.getFullYear()?o.format(c):r.format(c),c.toISOString()]}}function Wt(e,n){if(!(n instanceof HTMLElement))throw new Error("Unsuitable ancestor element");const t=n.querySelector("time");if(!(t instanceof HTMLTimeElement))throw new Error("Unable to locate time element under specified ancestor");const r=t.textContent;if(!r)return;const o=Date.parse(t.dateTime),[s]=e(o);r!==s&&(t.textContent=s)}var rs=["<time",">","</time>"],os=["<div","><header><strong>","</strong><!--$-->","<!--/--></header><input",' type="checkbox" class="c-brief__summary-state"><button',">Open note for preview</button><label",' class="c-brief__summary-toggle"><svg viewBox="0 0 512 512" aria-hidden="true" fill="currentColor" width="1em" height="1em"><path d="M60 99.333l196 196 196-196 60 60-256 256-256-256z"></path></svg></label><p class="c-brief__summary">',"</p></div>"],ss=["<span",' class="c-brief__no-content">(No Content)</span>'];const as=" js:c-brief--flash",is=[""," c-brief--pending"," c-brief--active"],cs=e=>"js:c-brief c-brief "+(e?as:""),ls=e=>"js:c-brief__open c-brief__open"+is[e];function us(e){let n;const t=He(),[r,o]=e.format(e.updatedAt);return qe(()=>{Wt(e.format,n)}),E(os,T()+R("class",g(cs(e.flushed),!0),!1)+R("data-note-id",g(e.noteId,!0),!1),g(e.title),g(p(pe,{get children(){return E(rs,T()+R("datetime",g(o,!0),!1),g(r))}})),R("id",g(t,!0),!1),R("class",g(ls(e.active),!0),!1),R("for",g(t,!0),!1),g(p(U,{get when(){return e.summary},get fallback(){return E(ss,T())},get children(){return e.summary}})))}const[ds,fs]=A(void 0,{equals:!1}),hs={lastEdit:ds,sendLastEdit:fs},ps=me(hs);function Kt(){const e=Q(ps);if(!e)throw new Error("AppContext not initialized");return e}const ms=Kt,gs=Kt;var ws=["<div",' class="c-brief-empty"><!--$-->',"<!--/--> </div>"],ys=["<ul",' class="c-brief-list">',"</ul>"],vs=["<nav",">","</nav>"],bs=["<li",">","</li>"];const Ss=e=>E(ws,T(),e.search?`Couldn't find any notes titled "${g(e.search)}"`:"No notes created yet!");function Es(e){if(!(e instanceof HTMLButtonElement&&e.classList.contains("js:c-brief__open")))return;const n=e.closest("div.js\\:c-brief");return n instanceof HTMLDivElement?n.dataset.noteId:void 0}function Rs(){return S?at():at(Intl.DateTimeFormat().resolvedOptions())}function Ts(e){const[n,t]=wn([]);return[async function(){const o=await es(e());return t(yn(o)),n},{initialValue:n}]}function $s(e,n){const t="";return()=>{const r=n();switch(r?.[0]){case void 0:case"delete":return t;case"update":return r[1];case"new":{const o=e();return typeof o=="string"&&o.length>0?o:t}default:return t}}}const Ns=([e,n],t)=>e===t?n:0;function As(e){const n=Qn(),t=()=>n.noteId??"",r=ye(),[o,s]=A({noteId:t(),pathname:r.pathname}),a=I(()=>{const d=o();if(r.pathname!==d.pathname&&d.noteId.length>0)return[d.noteId,1];const f=t();return f.length>0?[f,2]:["",0]}),i=Z(),l=d=>{const f=Es(d.target);if(!f)return;const w=jr(r,f);s({noteId:f,pathname:w.pathname}),i(w.href)},{lastEdit:u}=ms(),c=I($s(t,u)),h=Ct(...Ts(()=>e.searchText)),m=Rs();let y;return qe(()=>{y instanceof HTMLElement&&y.addEventListener("click",l)}),E(vs,T(),g(p(U,{get when(){return h().length},get fallback(){return p(Ss,{get search(){return e.searchText}})},get children(){return E(ys,T(),g(p(pn,{get each(){return h()},children:d=>E(bs,T(),g(p(us,{get noteId(){return d.id},get title(){return d.title},get summary(){return d.summary},get updatedAt(){return d.updatedAt},get active(){return Ns(a(),d.id)},get flushed(){return c()===d.id},format:m})))})))}})))}var xs=["<div",' class="c-note-preview"><div class="o-from-markdown">',"</div></div>"];const _s=S?globalThis.ssrSupport.mdToHtml:e=>"client";console.log("YYY",globalThis.ssrSupport,S);const zt=e=>E(xs,T(),e.body?_s(e.body):"");var Cs=["<button",' class="c-note-edit__delete" role="menuitem"','><img src="/cross.svg" width="10px" height="10px" alt="" role="presentation">Delete</button>'],Is=["<div",' class="c-note-edit"><form class="c-note-edit__form" method="post"','><input type="hidden" name="id"','><input type="hidden" name="from"','><input type="hidden" name="intent"','><label class="u-offscreen" for="note-edit__title">Enter a title for your note</label><input id="note-edit__title" type="text" name="title"','><label class="u-offscreen" for="note-edit__body">Enter the body for your note</label><textarea id="note-edit__body" name="body"','></textarea></form><div class="c-note-edit__preview"><div class="c-note-edit__menu" role="menubar"><button class="c-note-edit__done" role="menuitem"','><img src="/checkmark.svg" width="14px" height="10px" alt="" role="presentation">Done</button><!--$-->','<!--/--></div><div class="c-note-edit__label-preview" role="status">Preview</div><h1 class="c-note-edit__note-title">',"</h1><!--$-->","<!--/--></div></div>"];const Ls=e=>typeof e=="string"&&e.length>0?e:void 0;function Yt(e){const n=()=>!!Ls(e.noteId),[t,r]=A(n()?"update":"insert"),[o,s]=A(!1),[a,i]=A(e.initialTitle),l=()=>{const d=a();return d!==void 0?d:e.initialTitle??""},[u,c]=A(e.initialBody),h=()=>{const d=u();return d!==void 0?d:e.initialBody??""},m=ye(),{sendLastEdit:y}=gs();return y(void 0),E(Is,T(),R("action",g(ns,!0),!1),R("value",g(e.noteId,!0)??"",!1),R("value",g(kr(m),!0),!1),R("value",g(t(),!0),!1),R("value",g(l(),!0),!1),R("value",g(h(),!0),!1),R("disabled",o(),!0),g(p(U,{get when(){return n()},get children(){return E(Cs,T(),R("disabled",o(),!0))}})),g(l()),g(p(zt,{get body(){return h()}})))}var Ps=["<time",">","</time>"],Os=["<div",' class="c-note"><div class="c-note__header"><h1>','</h1><div class="c-note__menu" role="menubar"><small class="c-note__updated" role="status">Last updated on <!--$-->',"<!--/--></small><!--$-->","<!--/--></div></div><!--$-->","<!--/--></div>"];const Xt=S?st():st(Intl.DateTimeFormat().resolvedOptions());function ks(e,n){const t=({id:r,title:o,body:s,updatedAt:a})=>{const[i,l]=Xt(a);return{id:r,title:o,body:s,updatedAt:a,updatedISO:l,updated:i}};return function(o){if(o)return t(o);n(qr(e),{replace:!0})}}function Ds(e){const n=(r,o="")=>e.note?.[r]??o;let t;return qe(()=>{Wt(Xt,t)}),[p(te,{get children(){return ne(e.noteId)}}),E(Os,T(),g(n("title")),g(p(pe,{get children(){return E(Ps,T()+R("datetime",g(n("updatedISO"),!0),!1),g(n("updated")))}})),g(p(kt,{kind:"update",children:"Edit"})),g(p(zt,{get body(){return n("body")}})))]}function it(e){const n=()=>e.edit,t=()=>e.params.noteId,r=Z(),o=ks(e.location,r),s=Ct(()=>ts(t()).then(o),{deferStream:!0});return[p(te,{get children(){return ne(n()?`Edit ${t()}`:t())}}),p(U,{get when(){return n()},get fallback(){return p(Ds,{get noteId(){return t()},get note(){return s()}})},get children(){return p(Yt,{get noteId(){return t()},get initialTitle(){return s()?.title},get initialBody(){return s()?.body}})}})]}function Fs(){return[p(te,{get children(){return ne("New Note")}}),p(Yt,{noteId:void 0,initialTitle:"Untitled",initialBody:""})]}var Hs=["<div",' class="c-note-none"><span>Click a note on the left to view something! 🥺</span></div>'];function qs(){return[p(te,{get children(){return ne()}}),E(Hs,T())]}function Ms(e){e.forEach(n=>{if(!n.attrs.href)return;let t=document.head.querySelector(`link[href="${n.attrs.href}"]`);t||(t=document.createElement("link"),t.setAttribute("rel","preload"),t.setAttribute("as","style"),t.setAttribute("href",n.attrs.href),document.head.appendChild(t))})}var js=" ";const Bs={style:e=>Ee("style",e.attrs,()=>g(e.children),!0),link:e=>Ee("link",e.attrs,void 0,!0),script:e=>e.attrs.src?Ee("script",an(()=>e.attrs,{get id(){return e.key}}),()=>E(js),!0):null};function Fe(e){let{tag:n,attrs:{key:t,...r}={key:void 0},children:o}=e;return Bs[n]({attrs:r,key:t,children:o})}function Us(e,n,t,r="default"){return mn(async()=>{{const s=(await e.import())[r],i=(await n.inputs?.[e.src].assets()).filter(u=>u.tag==="style"||u.attrs.rel==="stylesheet");return typeof window<"u"&&Ms(i),{default:u=>[...i.map(c=>Fe(c)),mt(s,u)]}}})}const B={NORMAL:0,WILDCARD:1,PLACEHOLDER:2};function Ws(e={}){const n={options:e,rootNode:Gt(),staticRoutesMap:{}},t=r=>e.strictTrailingSlash?r:r.replace(/\/$/,"")||"/";if(e.routes)for(const r in e.routes)ct(n,t(r),e.routes[r]);return{ctx:n,lookup:r=>Ks(n,t(r)),insert:(r,o)=>ct(n,t(r),o),remove:r=>zs(n,t(r))}}function Ks(e,n){const t=e.staticRoutesMap[n];if(t)return t.data;const r=n.split("/"),o={};let s=!1,a=null,i=e.rootNode,l=null;for(let u=0;u<r.length;u++){const c=r[u];i.wildcardChildNode!==null&&(a=i.wildcardChildNode,l=r.slice(u).join("/"));const h=i.children.get(c);if(h!==void 0)i=h;else if(i=i.placeholderChildNode,i!==null)o[i.paramName]=c,s=!0;else break}return(i===null||i.data===null)&&a!==null&&(i=a,o[i.paramName||"_"]=l,s=!0),i?s?{...i.data,params:s?o:void 0}:i.data:null}function ct(e,n,t){let r=!0;const o=n.split("/");let s=e.rootNode,a=0;for(const i of o){let l;if(l=s.children.get(i))s=l;else{const u=Ys(i);l=Gt({type:u,parent:s}),s.children.set(i,l),u===B.PLACEHOLDER?(l.paramName=i==="*"?`_${a++}`:i.slice(1),s.placeholderChildNode=l,r=!1):u===B.WILDCARD&&(s.wildcardChildNode=l,l.paramName=i.slice(3)||"_",r=!1),s=l}}return s.data=t,r===!0&&(e.staticRoutesMap[n]=s),s}function zs(e,n){let t=!1;const r=n.split("/");let o=e.rootNode;for(const s of r)if(o=o.children.get(s),!o)return t;if(o.data){const s=r[r.length-1];if(o.data=null,Object.keys(o.children).length===0){const a=o.parent;a.children.delete(s),a.wildcardChildNode=null,a.placeholderChildNode=null}t=!0}return t}function Gt(e={}){return{type:e.type||B.NORMAL,parent:e.parent||null,children:new Map,data:e.data||null,paramName:e.paramName||null,wildcardChildNode:null,placeholderChildNode:null}}function Ys(e){return e.startsWith("**")?B.WILDCARD:e[0]===":"||e==="*"?B.PLACEHOLDER:B.NORMAL}const Vt=[],Xs=Gs(Vt.filter(e=>e.$component));function Gs(e){function n(t,r,o,s){const a=Object.values(t).find(i=>o.startsWith(i.id+"/"));return a?(n(a.children||(a.children=[]),r,o.slice(a.id.length)),t):(t.push({...r,id:o,path:o.replace(/\/\([^)/]+\)/g,"")}),t)}return e.sort((t,r)=>t.path.length-r.path.length).reduce((t,r)=>n(t,r,r.path,r.path),[])}function Vs(e,n){const t=Qs.lookup(e);if(t){const r=t.route[`$${n}`];return r===void 0?void 0:{handler:r,params:t.params}}}function Js(e){return e.$GET||e.$POST||e.$PUT||e.$PATCH||e.$DELETE}const Qs=Ws({routes:Vt.reduce((e,n)=>{if(!Js(n))return e;let t=n.path.replace(/\(.*\)\/?/g,"").replace(/\*([^/]*)/g,(r,o)=>`**:${o}`);if(/:[^/]*\?/g.test(t))throw new Error(`Optional parameters are not supported in API routes: ${t}`);if(e[t])throw new Error(`Duplicate API routes for "${t}" found at "${e[t].route.path}" and "${n.path}"`);return e[t]={route:n},e},{})});function Zs(){function e(t){return{...t,...t.$$route?t.$$route.require().route:void 0,info:{...t.$$route?t.$$route.require().route.info:{},filesystem:!0},component:Us(t.$component,globalThis.MANIFEST.client,globalThis.MANIFEST.ssr),children:t.children?t.children.map(e):void 0}}return Xs.map(e)}function Jt(e){if(S){const n=L();n.response.status=e.code,n.response.statusText=e.text,H(()=>!n.nativeEvent.handled&&(n.response.status=200))}return null}var ea=["<div",' class="c-not-found"><!--$-->',"<!--/--><!--$-->",'<!--/--><h1>Page Not Found</h1><p class="c-info-learn">Visit <a href="https://start.solidjs.com" target="_blank">start.solidjs.com</a> to learn how to build SolidStart apps.</p></div>'];function ta(){return E(ea,T(),g(p(te,{get children(){return ne("Not Found")}})),g(p(Jt,{code:404})))}var na=["<main",' class="c-main"><section class="c-sidebar c-main__column"><section class="c-sidebar__header"><img class="c-logo" src="/logo.svg" width="22px" height="20px" alt="" role="presentation"><strong>Solid Notes</strong></section><section class="c-sidebar__menu" role="menubar"><!--$-->',"<!--/--><!--$-->","<!--/--></section><!--$-->",'<!--/--></section><section class="c-note-view c-main__column">',"</section></main>"];function ra(e){const[n]=Tt();return p(xr,{get children(){return E(na,T(),g(p(Gr,{})),g(p(kt,{kind:"new",children:"New"})),g(p(Ge,{get children(){return p(As,{get searchText(){return n.search}})}})),g(p(Ge,{get children(){return e.children}})))}})}function oa(){const e=t=>it($e({edit:!0},t)),n=t=>it($e({edit:!1},t));return p(Tr,{root:ra,get children(){return[p(K,{path:"/new",component:Fs}),p(K,{path:"/notes/:noteId/edit",component:e}),p(K,{path:"/notes/:noteId",component:n}),p(K,{path:"/",component:qs}),p(K,{path:"*404",component:ta})]}})}function sa(e){return p(gn,{get fallback(){return p(Jt,{code:500})},get children(){return e.children}})}var aa=["<script",">","<\/script>"],ia=["<script",' type="module" async',"><\/script>"];const ca=E("<!DOCTYPE html>");function Qt(e,n,t=[]){for(let r=0;r<n.length;r++){const o=n[r];if(o.path!==e[0].path)continue;let s=[...t,o];if(o.children){const a=e.slice(1);if(a.length===0||(s=Qt(a,o.children,s),!s))continue}return s}}function la(e){const n=L();let t=[];return Promise.resolve().then(async()=>{if(n.router&&n.router.matches){const r=[...n.router.matches];for(;r.length&&(!r[0].info||!r[0].info.filesystem);)r.shift();const o=r.length&&Qt(r,n.routes);if(o)for(let s=0;s<o.length;s++){const a=o[s],l=await globalThis.MANIFEST.client.inputs[a.$component.src].assets();t.push.apply(t,l)}else console.warn("No route matched for preloading js assets")}t=[...new Map(t.map(r=>[r.attrs.key,r])).values()].filter(r=>r.attrs.rel==="modulepreload"&&!n.assets.find(o=>o.attrs.key===r.attrs.key))}),dt(()=>t.length?t.map(r=>Fe(r)):void 0),p(pe,{get children(){return[ca,p(e.document,{get assets(){return[p(cn,{}),n.assets.map(r=>Fe(r))]},get scripts(){return[E(aa,T(),`window.manifest = ${JSON.stringify(n.manifest)}`),E(ia,T(),R("src",g(globalThis.MANIFEST.client.inputs[globalThis.MANIFEST.client.handler].output.path,!0),!1))]},get children(){return p(ln,{get children(){return p(sa,{get children(){return p(oa,{})}})}})}})]}})}function ua(e){const n=lo(e,"flash");if(!n)return;let t=JSON.parse(n);if(!t||!t.result)return[];const r=[...t.input.slice(0,-1),new Map(t.input[t.input.length-1])];return uo(e,"flash","",{maxAge:0}),{url:t.url,result:t.error?new Error(t.result):t.result,input:r}}async function Zt(e){const n=globalThis.MANIFEST.client;return globalThis.MANIFEST.ssr,e.response.headers.set("Content-Type","text/html"),Object.assign(e,{manifest:await n.json(),assets:[...await n.inputs[n.handler].assets()],router:{submission:ua(e)},routes:Zs(),$islands:new Set})}function da(e,n={}){return On({onRequest:n.onRequest,onBeforeResponse:n.onBeforeResponse,handler:t=>{const r=bo(t);return wt(r,async()=>{const o=Vs(new URL(r.request.url).pathname,r.request.method);if(o){const h=(await o.handler.import())[r.request.method];r.params=o.params||{},C.context={event:r};const m=await h(r);if(m!==void 0)return m;if(r.request.method!=="GET")throw new Error(`API handler for ${r.request.method} "${r.request.url}" did not return a response.`)}const s=await Zt(r);let a={...n};if(a.onCompleteAll){const c=a.onCompleteAll;a.onCompleteAll=h=>{ut(s)(h),c(h)}}else a.onCompleteAll=ut(s);if(a.onCompleteShell){const c=a.onCompleteShell;a.onCompleteShell=h=>{lt(s,t)(),c(h)}}else a.onCompleteShell=lt(s,t);const i=un(()=>(C.context.event=s,e(s)),a);if(s.response&&s.response.headers.get("Location"))return co(r,s.response.headers.get("Location"));const{writable:l,readable:u}=new TransformStream;return i.pipeTo(l),u})}})}function lt(e,n){return()=>{e.response&&e.response.headers.get("Location")&&(Pe(n,302),fo(n,"Location",e.response.headers.get("Location")))}}function ut(e){return({write:n})=>{const t=e.response&&e.response.headers.get("Location");t&&n(`<script>window.location="${t}"<\/script>`)}}function fa(e,n={}){return da(e,{...n,createPageEvent:Zt})}var ha=['<head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico">',"</head>"],pa=["<html",' lang="en">','<body><div id="app">',"</div><!--$-->","<!--/--></body></html>"];globalThis.ssrSupport={mdToHtml:e=>"server"};console.log("XXX",globalThis.ssrSupport);const Aa=fa(()=>p(la,{document:({assets:e,children:n,scripts:t})=>E(pa,T(),p(pe,{get children(){return E(ha,g(e))}}),g(n),g(t))}));export{Aa as default};
