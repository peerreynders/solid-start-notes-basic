import{lazy as Ir,createComponent as zt,getOwner as re,runWithOwner as Et,createMemo as k,createContext as be,useContext as ne,untrack as me,createSignal as A,createRenderEffect as Rt,on as It,startTransition as Y,resetErrorBoundaries as nt,children as At,mergeProps as Te,createRoot as Ar,Show as W,onCleanup as V,getListener as xr,sharedConfig as $,createResource as Pr,createUniqueId as He,onMount as Ke,For as $r,Suspense as st}from"solid-js";import{ssrElement as Ae,escape as m,mergeProps as kr,ssr as E,isServer as w,getRequestEvent as _,createComponent as g,delegateEvents as Or,spread as it,useAssets as Fr,ssrHydrationKey as I,ssrAttribute as z,NoHydration as xt,renderToString as Tr}from"solid-js/web";import{provideRequestEvent as Pt}from"solid-js/web/storage";import{g as Cr,s as _r,a as Nr,b as jr,u as Lr,d as Dr,c as Mr,m as at,e as Vr,f as Ur,h as Br}from"./api.js";import{createStore as qr,reconcile as Wr}from"solid-js/store";import{eventHandler as Hr}from"h3";import"node:async_hooks";import"unstorage";import"unstorage/drivers/fs-lite";import"rxjs";import"nanoid";import"marked";import"sanitize-html";var Kr=(e=>(e[e.AggregateError=1]="AggregateError",e[e.ArrowFunction=2]="ArrowFunction",e[e.ErrorPrototypeStack=4]="ErrorPrototypeStack",e[e.ObjectAssign=8]="ObjectAssign",e[e.BigIntTypedArray=16]="BigIntTypedArray",e))(Kr||{});function C(e,t){if(!e)throw t}function Xr(e){switch(e){case'"':return'\\"';case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r";case"\b":return"\\b";case"	":return"\\t";case"\f":return"\\f";case"<":return"\\x3C";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return}}function O(e){let t="",r=0,n;for(let s=0,i=e.length;s<i;s++)n=Xr(e[s]),n&&(t+=e.slice(r,s)+n,r=s+1);return r===0?t=e:t+=e.slice(r),t}function Gr(e){switch(e){case"\\\\":return"\\";case'\\"':return'"';case"\\n":return`
`;case"\\r":return"\r";case"\\b":return"\b";case"\\t":return"	";case"\\f":return"\f";case"\\x3C":return"<";case"\\u2028":return"\u2028";case"\\u2029":return"\u2029";default:return e}}function M(e){return e.replace(/(\\\\|\\"|\\n|\\r|\\b|\\t|\\f|\\u2028|\\u2029|\\x3C)/g,Gr)}var G="__SEROVAL_REFS__",fe="$R",he=`self.${fe}`;function Jr(e){return e==null?`${he}=${he}||[]`:`(${he}=${he}||{})["${O(e)}"]=[]`}var $t=new Map,B=new Map;function Ce(e){return $t.has(e)}function Yr(e){return B.has(e)}function Zr(e){return C(Ce(e),new Dn(e)),$t.get(e)}function Qr(e){return C(Yr(e),new Mn(e)),B.get(e)}typeof globalThis<"u"?Object.defineProperty(globalThis,G,{value:B,configurable:!0,writable:!1,enumerable:!1}):typeof window<"u"?Object.defineProperty(window,G,{value:B,configurable:!0,writable:!1,enumerable:!1}):typeof self<"u"?Object.defineProperty(self,G,{value:B,configurable:!0,writable:!1,enumerable:!1}):typeof global<"u"&&Object.defineProperty(global,G,{value:B,configurable:!0,writable:!1,enumerable:!1});function kt(e,t){for(let r=0,n=t.length;r<n;r++){let s=t[r];e.has(s)||(e.add(s),s.extends&&kt(e,s.extends))}}function Ot(e){if(e){let t=new Set;return kt(t,e),[...t]}}var en={0:"Symbol.asyncIterator",1:"Symbol.hasInstance",2:"Symbol.isConcatSpreadable",3:"Symbol.iterator",4:"Symbol.match",5:"Symbol.matchAll",6:"Symbol.replace",7:"Symbol.search",8:"Symbol.species",9:"Symbol.split",10:"Symbol.toPrimitive",11:"Symbol.toStringTag",12:"Symbol.unscopables"},Ft={[Symbol.asyncIterator]:0,[Symbol.hasInstance]:1,[Symbol.isConcatSpreadable]:2,[Symbol.iterator]:3,[Symbol.match]:4,[Symbol.matchAll]:5,[Symbol.replace]:6,[Symbol.search]:7,[Symbol.species]:8,[Symbol.split]:9,[Symbol.toPrimitive]:10,[Symbol.toStringTag]:11,[Symbol.unscopables]:12},tn={0:Symbol.asyncIterator,1:Symbol.hasInstance,2:Symbol.isConcatSpreadable,3:Symbol.iterator,4:Symbol.match,5:Symbol.matchAll,6:Symbol.replace,7:Symbol.search,8:Symbol.species,9:Symbol.split,10:Symbol.toPrimitive,11:Symbol.toStringTag,12:Symbol.unscopables},rn={2:"!0",3:"!1",1:"void 0",0:"null",4:"-0",5:"1/0",6:"-1/0",7:"0/0"},nn={2:!0,3:!1,1:void 0,0:null,4:-0,5:1/0,6:-1/0,7:NaN},Tt={0:"Error",1:"EvalError",2:"RangeError",3:"ReferenceError",4:"SyntaxError",5:"TypeError",6:"URIError"},sn={0:Error,1:EvalError,2:RangeError,3:ReferenceError,4:SyntaxError,5:TypeError,6:URIError};function j(e){return{t:2,i:void 0,s:e,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}var _e=j(2),Ne=j(3),an=j(1),on=j(0),ln=j(4),cn=j(5),un=j(6),dn=j(7);function Xe(e){return e instanceof EvalError?1:e instanceof RangeError?2:e instanceof ReferenceError?3:e instanceof SyntaxError?4:e instanceof TypeError?5:e instanceof URIError?6:0}function hn(e){let t=Tt[Xe(e)];return e.name!==t?{name:e.name}:e.constructor.name!==t?{name:e.constructor.name}:{}}function ot(e,t){let r=hn(e),n=Object.getOwnPropertyNames(e);for(let s=0,i=n.length,a;s<i;s++)a=n[s],a!=="name"&&a!=="message"&&(a==="stack"?t&4&&(r=r||{},r[a]=e[a]):(r=r||{},r[a]=e[a]));return r}function Ct(e){return Object.isFrozen(e)?3:Object.isSealed(e)?2:Object.isExtensible(e)?0:1}function fn(e){switch(e){case 1/0:return cn;case-1/0:return un}return e!==e?dn:Object.is(e,-0)?ln:{t:0,i:void 0,s:e,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function je(e){return{t:1,i:void 0,s:O(e),l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function pn(e){return{t:3,i:void 0,s:""+e,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function mn(e){return{t:4,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function gn(e,t){return{t:5,i:e,s:t.toISOString(),l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,f:void 0,a:void 0,b:void 0,o:void 0}}function vn(e,t){return{t:6,i:e,s:void 0,l:void 0,c:O(t.source),m:t.flags,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function yn(e,t){let r=new Uint8Array(t),n=r.length,s=new Array(n);for(let i=0;i<n;i++)s[i]=r[i];return{t:19,i:e,s,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function bn(e,t){return{t:17,i:e,s:Ft[t],l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function lt(e,t){return{t:18,i:e,s:O(Zr(t)),l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function _t(e,t,r){return{t:25,i:e,s:r,l:void 0,c:O(t),m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function wn(e,t,r){return{t:9,i:e,s:void 0,l:t.length,c:void 0,m:void 0,p:void 0,e:void 0,a:r,f:void 0,b:void 0,o:Ct(t)}}function Sn(e,t){return{t:21,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:t,b:void 0,o:void 0}}function zn(e,t,r){return{t:15,i:e,s:void 0,l:t.length,c:t.constructor.name,m:void 0,p:void 0,e:void 0,a:void 0,f:r,b:t.byteOffset,o:void 0}}function En(e,t,r){return{t:16,i:e,s:void 0,l:t.length,c:t.constructor.name,m:void 0,p:void 0,e:void 0,a:void 0,f:r,b:t.byteOffset,o:void 0}}function Rn(e,t,r){return{t:20,i:e,s:void 0,l:t.byteLength,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:r,b:t.byteOffset,o:void 0}}function In(e,t,r){return{t:13,i:e,s:Xe(t),l:void 0,c:void 0,m:O(t.message),p:r,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function An(e,t,r){return{t:14,i:e,s:Xe(t),l:void 0,c:void 0,m:O(t.message),p:r,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function xn(e,t,r){return{t:7,i:e,s:void 0,l:t,c:void 0,m:void 0,p:void 0,e:void 0,a:r,f:void 0,b:void 0,o:void 0}}function Nt(e,t){return{t:28,i:void 0,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[e,t],f:void 0,b:void 0,o:void 0}}function jt(e,t){return{t:30,i:void 0,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[e,t],f:void 0,b:void 0,o:void 0}}function Lt(e,t,r){return{t:31,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:r,f:t,b:void 0,o:void 0}}function Pn(e,t){return{t:32,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:t,b:void 0,o:void 0}}function $n(e,t){return{t:33,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:t,b:void 0,o:void 0}}function kn(e,t){return{t:34,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:t,b:void 0,o:void 0}}function Dt(e){let t=[],r=-1,n=-1,s=e[Symbol.iterator]();for(;;)try{let i=s.next();if(t.push(i.value),i.done){n=t.length-1;break}}catch(i){r=t.length,t.push(i)}return{v:t,t:r,d:n}}function On(e){return()=>{let t=0;return{[Symbol.iterator](){return this},next(){if(t>e.d)return{done:!0,value:void 0};let r=t++,n=e.v[r];if(r===e.t)throw n;return{done:r===e.d,value:n}}}}}var Fn={},Tn={},Cn={0:{},1:{},2:{},3:{},4:{}},{toString:Ge}=Object.prototype;function _n(e,t){return t instanceof Error?`Seroval caught an error during the ${e} process.
  
${t.name}
${t.message}

- For more information, please check the "cause" property of this error.
- If you believe this is an error in Seroval, please submit an issue at https://github.com/lxsmnsyc/seroval/issues/new`:`Seroval caught an error during the ${e} process.

"${Ge.call(t)}"

For more information, please check the "cause" property of this error.`}var Je=class extends Error{constructor(t,r){super(_n(t,r)),this.cause=r}},Nn=class extends Je{constructor(e){super("parsing",e)}},jn=class extends Je{constructor(e){super("serialization",e)}},Ln=class extends Je{constructor(e){super("deserialization",e)}},ge=class extends Error{constructor(t){super(`The value ${Ge.call(t)} of type "${typeof t}" cannot be parsed/serialized.
      
There are few workarounds for this problem:
- Transform the value in a way that it can be serialized.
- If the reference is present on multiple runtimes (isomorphic), you can use the Reference API to map the references.`),this.value=t}},Mt=class extends Error{constructor(t){super('Unsupported node type "'+t.t+'".')}},Vt=class extends Error{constructor(t){super('Missing plugin for tag "'+t+'".')}},K=class extends Error{constructor(t){super('Missing "'+t+'" instance.')}},Dn=class extends Error{constructor(t){super('Missing reference for the value "'+Ge.call(t)+'" of type "'+typeof t+'"'),this.value=t}},Mn=class extends Error{constructor(e){super('Missing reference for id "'+O(e)+'"')}},Vn=class extends Error{constructor(e){super('Unknown TypedArray "'+e+'"')}},Un=class{constructor(t){this.marked=new Set,this.plugins=t.plugins,this.features=31^(t.disabledFeatures||0),this.refs=t.refs||new Map}markRef(t){this.marked.add(t)}isMarked(t){return this.marked.has(t)}getIndexedValue(t){let r=this.refs.get(t);if(r!=null)return this.markRef(r),{type:1,value:mn(r)};let n=this.refs.size;return this.refs.set(t,n),{type:0,value:n}}getReference(t){let r=this.getIndexedValue(t);return r.type===1?r:Ce(t)?{type:2,value:lt(r.value,t)}:r}getStrictReference(t){C(Ce(t),new ge(t));let r=this.getIndexedValue(t);return r.type===1?r.value:lt(r.value,t)}parseFunction(t){return this.getStrictReference(t)}parseWellKnownSymbol(t){let r=this.getReference(t);return r.type!==0?r.value:(C(t in Ft,new ge(t)),bn(r.value,t))}parseSpecialReference(t){let r=this.getIndexedValue(Cn[t]);return r.type===1?r.value:{t:26,i:r.value,s:t,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}parseIteratorFactory(){let t=this.getIndexedValue(Fn);return t.type===1?t.value:{t:27,i:t.value,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:this.parseWellKnownSymbol(Symbol.iterator),b:void 0,o:void 0}}parseAsyncIteratorFactory(){let t=this.getIndexedValue(Tn);return t.type===1?t.value:{t:29,i:t.value,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[this.parseSpecialReference(1),this.parseWellKnownSymbol(Symbol.asyncIterator)],f:void 0,b:void 0,o:void 0}}createObjectNode(t,r,n,s){return{t:n?11:10,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:s,e:void 0,a:void 0,f:void 0,b:void 0,o:Ct(r)}}createMapNode(t,r,n,s){return{t:8,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:{k:r,v:n,s},a:void 0,f:this.parseSpecialReference(0),b:void 0,o:void 0}}createPromiseConstructorNode(t){return{t:22,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:this.parseSpecialReference(1),b:void 0,o:void 0}}};function Le(){let e,t;return{promise:new Promise((r,n)=>{e=r,t=n}),resolve(r){e(r)},reject(r){t(r)}}}function Bn(e){return"__SEROVAL_STREAM__"in e}function se(){let e=new Set,t=[],r=!0,n=!1;function s(o){for(let l of e.keys())l.next(o)}function i(o){for(let l of e.keys())l.throw(o)}function a(o){for(let l of e.keys())l.return(o)}return{__SEROVAL_STREAM__:!0,on(o){r&&e.add(o);for(let l=0,u=t.length;l<u;l++){let c=t[l];l===u-1?n?o.return(c):o.throw(c):o.next(c)}return()=>{r&&e.delete(o)}},next(o){r&&(t.push(o),s(o))},throw(o){r&&(t.push(o),i(o),r=!1,n=!1,e.clear())},return(o){r&&(t.push(o),a(o),r=!1,n=!0,e.clear())}}}function qn(e){let t=se(),r=e[Symbol.asyncIterator]();async function n(){try{let s=await r.next();s.done?t.return(s.value):(t.next(s.value),await n())}catch(s){t.throw(s)}}return n().catch(()=>{}),t}function Wn(e){return()=>{let t=[],r=[],n=0,s=-1,i=!1;function a(){for(let l=0,u=r.length;l<u;l++)r[l].resolve({done:!0,value:void 0})}e.on({next(l){let u=r.shift();u&&u.resolve({done:!1,value:l}),t.push(l)},throw(l){let u=r.shift();u&&u.reject(l),a(),s=t.length,t.push(l),i=!0},return(l){let u=r.shift();u&&u.resolve({done:!0,value:l}),a(),s=t.length,t.push(l)}});function o(){let l=n++,u=t[l];if(l!==s)return{done:!1,value:u};if(i)throw u;return{done:!0,value:u}}return{[Symbol.asyncIterator](){return this},async next(){if(s===-1){let l=n++;if(l>=t.length){let u=Le();return r.push(u),await u.promise}return{done:!1,value:t[l]}}return n>s?{done:!0,value:void 0}:o()}}}}function Hn(e){switch(e){case"Int8Array":return Int8Array;case"Int16Array":return Int16Array;case"Int32Array":return Int32Array;case"Uint8Array":return Uint8Array;case"Uint16Array":return Uint16Array;case"Uint32Array":return Uint32Array;case"Uint8ClampedArray":return Uint8ClampedArray;case"Float32Array":return Float32Array;case"Float64Array":return Float64Array;case"BigInt64Array":return BigInt64Array;case"BigUint64Array":return BigUint64Array;default:throw new Vn(e)}}function ct(e,t){switch(t){case 3:return Object.freeze(e);case 1:return Object.preventExtensions(e);case 2:return Object.seal(e);default:return e}}var Kn=class{constructor(t){this.plugins=t.plugins,this.refs=t.refs||new Map}deserializeReference(t){return this.assignIndexedValue(t.i,Qr(M(t.s)))}deserializeArray(t){let r=t.l,n=this.assignIndexedValue(t.i,new Array(r)),s;for(let i=0;i<r;i++)s=t.a[i],s&&(n[i]=this.deserialize(s));return ct(n,t.o),n}deserializeProperties(t,r){let n=t.s;if(n){let s=t.k,i=t.v;for(let a=0,o;a<n;a++)o=s[a],typeof o=="string"?r[M(o)]=this.deserialize(i[a]):r[this.deserialize(o)]=this.deserialize(i[a])}return r}deserializeObject(t){let r=this.assignIndexedValue(t.i,t.t===10?{}:Object.create(null));return this.deserializeProperties(t.p,r),ct(r,t.o),r}deserializeDate(t){return this.assignIndexedValue(t.i,new Date(t.s))}deserializeRegExp(t){return this.assignIndexedValue(t.i,new RegExp(M(t.c),t.m))}deserializeSet(t){let r=this.assignIndexedValue(t.i,new Set),n=t.a;for(let s=0,i=t.l;s<i;s++)r.add(this.deserialize(n[s]));return r}deserializeMap(t){let r=this.assignIndexedValue(t.i,new Map),n=t.e.k,s=t.e.v;for(let i=0,a=t.e.s;i<a;i++)r.set(this.deserialize(n[i]),this.deserialize(s[i]));return r}deserializeArrayBuffer(t){let r=new Uint8Array(t.s);return this.assignIndexedValue(t.i,r.buffer)}deserializeTypedArray(t){let r=Hn(t.c),n=this.deserialize(t.f);return this.assignIndexedValue(t.i,new r(n,t.b,t.l))}deserializeDataView(t){let r=this.deserialize(t.f);return this.assignIndexedValue(t.i,new DataView(r,t.b,t.l))}deserializeDictionary(t,r){if(t.p){let n=this.deserializeProperties(t.p,{});Object.assign(r,n)}return r}deserializeAggregateError(t){let r=this.assignIndexedValue(t.i,new AggregateError([],M(t.m)));return this.deserializeDictionary(t,r)}deserializeError(t){let r=sn[t.s],n=this.assignIndexedValue(t.i,new r(M(t.m)));return this.deserializeDictionary(t,n)}deserializePromise(t){let r=Le(),n=this.assignIndexedValue(t.i,r),s=this.deserialize(t.f);return t.s?r.resolve(s):r.reject(s),n.promise}deserializeBoxed(t){return this.assignIndexedValue(t.i,Object(this.deserialize(t.f)))}deserializePlugin(t){let r=this.plugins;if(r){let n=M(t.c);for(let s=0,i=r.length;s<i;s++){let a=r[s];if(a.tag===n)return this.assignIndexedValue(t.i,a.deserialize(t.s,this,{id:t.i}))}}throw new Vt(t.c)}deserializePromiseConstructor(t){return this.assignIndexedValue(t.i,Le()).promise}deserializePromiseResolve(t){let r=this.refs.get(t.i);C(r,new K("Promise")),r.resolve(this.deserialize(t.a[1]))}deserializePromiseReject(t){let r=this.refs.get(t.i);C(r,new K("Promise")),r.reject(this.deserialize(t.a[1]))}deserializeIteratorFactoryInstance(t){this.deserialize(t.a[0]);let r=this.deserialize(t.a[1]);return On(r)}deserializeAsyncIteratorFactoryInstance(t){this.deserialize(t.a[0]);let r=this.deserialize(t.a[1]);return Wn(r)}deserializeStreamConstructor(t){let r=this.assignIndexedValue(t.i,se()),n=t.a.length;if(n)for(let s=0;s<n;s++)this.deserialize(t.a[s]);return r}deserializeStreamNext(t){let r=this.refs.get(t.i);C(r,new K("Stream")),r.next(this.deserialize(t.f))}deserializeStreamThrow(t){let r=this.refs.get(t.i);C(r,new K("Stream")),r.throw(this.deserialize(t.f))}deserializeStreamReturn(t){let r=this.refs.get(t.i);C(r,new K("Stream")),r.return(this.deserialize(t.f))}deserializeIteratorFactory(t){this.deserialize(t.f)}deserializeAsyncIteratorFactory(t){this.deserialize(t.a[1])}deserialize(t){try{switch(t.t){case 2:return nn[t.s];case 0:return t.s;case 1:return M(t.s);case 3:return BigInt(t.s);case 4:return this.refs.get(t.i);case 18:return this.deserializeReference(t);case 9:return this.deserializeArray(t);case 10:case 11:return this.deserializeObject(t);case 5:return this.deserializeDate(t);case 6:return this.deserializeRegExp(t);case 7:return this.deserializeSet(t);case 8:return this.deserializeMap(t);case 19:return this.deserializeArrayBuffer(t);case 16:case 15:return this.deserializeTypedArray(t);case 20:return this.deserializeDataView(t);case 14:return this.deserializeAggregateError(t);case 13:return this.deserializeError(t);case 12:return this.deserializePromise(t);case 17:return tn[t.s];case 21:return this.deserializeBoxed(t);case 25:return this.deserializePlugin(t);case 22:return this.deserializePromiseConstructor(t);case 23:return this.deserializePromiseResolve(t);case 24:return this.deserializePromiseReject(t);case 28:return this.deserializeIteratorFactoryInstance(t);case 30:return this.deserializeAsyncIteratorFactoryInstance(t);case 31:return this.deserializeStreamConstructor(t);case 32:return this.deserializeStreamNext(t);case 33:return this.deserializeStreamThrow(t);case 34:return this.deserializeStreamReturn(t);case 27:return this.deserializeIteratorFactory(t);case 29:return this.deserializeAsyncIteratorFactory(t);default:throw new Mt(t)}}catch(r){throw new Ln(r)}}},Xn=class extends Kn{constructor(t){super(t),this.mode="vanilla",this.marked=new Set(t.markedRefs)}assignIndexedValue(t,r){return this.marked.has(t)&&this.refs.set(t,r),r}},Gn=/^[$A-Z_][0-9A-Z_$]*$/i;function ut(e){let t=e[0];return(t==="$"||t==="_"||t>="A"&&t<="Z"||t>="a"&&t<="z")&&Gn.test(e)}function J(e){switch(e.t){case 0:return e.s+"="+e.v;case 2:return e.s+".set("+e.k+","+e.v+")";case 1:return e.s+".add("+e.v+")";case 3:return e.s+".delete("+e.k+")"}}function Jn(e){let t=[],r=e[0];for(let n=1,s=e.length,i,a=r;n<s;n++)i=e[n],i.t===0&&i.v===a.v?r={t:0,s:i.s,k:void 0,v:J(r)}:i.t===2&&i.s===a.s?r={t:2,s:J(r),k:i.k,v:i.v}:i.t===1&&i.s===a.s?r={t:1,s:J(r),k:void 0,v:i.v}:i.t===3&&i.s===a.s?r={t:3,s:J(r),k:i.k,v:void 0}:(t.push(r),r=i),a=i;return t.push(r),t}function dt(e){if(e.length){let t="",r=Jn(e);for(let n=0,s=r.length;n<s;n++)t+=J(r[n])+",";return t}}var Yn="Object.create(null)",Zn="new Set",Qn="new Map",es="Promise.resolve",ts="Promise.reject",rs={3:"Object.freeze",2:"Object.seal",1:"Object.preventExtensions",0:void 0},ns=class{constructor(e){this.stack=[],this.flags=[],this.assignments=[],this.plugins=e.plugins,this.features=e.features,this.marked=new Set(e.markedRefs)}createFunction(e,t){return this.features&2?(e.length===1?e[0]:"("+e.join(",")+")")+"=>"+t:"function("+e.join(",")+"){return "+t+"}"}createEffectfulFunction(e,t){return this.features&2?(e.length===1?e[0]:"("+e.join(",")+")")+"=>{"+t+"}":"function("+e.join(",")+"){"+t+"}"}markRef(e){this.marked.add(e)}isMarked(e){return this.marked.has(e)}pushObjectFlag(e,t){e!==0&&(this.markRef(t),this.flags.push({type:e,value:this.getRefParam(t)}))}resolveFlags(){let e="";for(let t=0,r=this.flags,n=r.length;t<n;t++){let s=r[t];e+=rs[s.type]+"("+s.value+"),"}return e}resolvePatches(){let e=dt(this.assignments),t=this.resolveFlags();return e?t?e+t:e:t}createAssignment(e,t){this.assignments.push({t:0,s:e,k:void 0,v:t})}createAddAssignment(e,t){this.assignments.push({t:1,s:this.getRefParam(e),k:void 0,v:t})}createSetAssignment(e,t,r){this.assignments.push({t:2,s:this.getRefParam(e),k:t,v:r})}createDeleteAssignment(e,t){this.assignments.push({t:3,s:this.getRefParam(e),k:t,v:void 0})}createArrayAssign(e,t,r){this.createAssignment(this.getRefParam(e)+"["+t+"]",r)}createObjectAssign(e,t,r){this.createAssignment(this.getRefParam(e)+"."+t,r)}isIndexedValueInStack(e){return e.t===4&&this.stack.includes(e.i)}serializeReference(e){return this.assignIndexedValue(e.i,G+'.get("'+e.s+'")')}serializeArrayItem(e,t,r){return t?this.isIndexedValueInStack(t)?(this.markRef(e),this.createArrayAssign(e,r,this.getRefParam(t.i)),""):this.serialize(t):""}serializeArray(e){let t=e.i;if(e.l){this.stack.push(t);let r=e.a,n=this.serializeArrayItem(t,r[0],0),s=n==="";for(let i=1,a=e.l,o;i<a;i++)o=this.serializeArrayItem(t,r[i],i),n+=","+o,s=o==="";return this.stack.pop(),this.pushObjectFlag(e.o,e.i),this.assignIndexedValue(t,"["+n+(s?",]":"]"))}return this.assignIndexedValue(t,"[]")}serializeProperty(e,t,r){if(typeof t=="string"){let n=Number(t),s=n>=0&&n.toString()===t||ut(t);if(this.isIndexedValueInStack(r)){let i=this.getRefParam(r.i);return this.markRef(e.i),s&&n!==n?this.createObjectAssign(e.i,t,i):this.createArrayAssign(e.i,s?t:'"'+t+'"',i),""}return(s?t:'"'+t+'"')+":"+this.serialize(r)}return"["+this.serialize(t)+"]:"+this.serialize(r)}serializeProperties(e,t){let r=t.s;if(r){let n=t.k,s=t.v;this.stack.push(e.i);let i=this.serializeProperty(e,n[0],s[0]);for(let a=1,o=i;a<r;a++)o=this.serializeProperty(e,n[a],s[a]),i+=(o&&i&&",")+o;return this.stack.pop(),"{"+i+"}"}return"{}"}serializeObject(e){return this.pushObjectFlag(e.o,e.i),this.assignIndexedValue(e.i,this.serializeProperties(e,e.p))}serializeWithObjectAssign(e,t,r){let n=this.serializeProperties(e,t);return n!=="{}"?"Object.assign("+r+","+n+")":r}serializeStringKeyAssignment(e,t,r,n){let s=this.serialize(n),i=Number(r),a=i>=0&&i.toString()===r||ut(r);if(this.isIndexedValueInStack(n))a&&i!==i?this.createObjectAssign(e.i,r,s):this.createArrayAssign(e.i,a?r:'"'+r+'"',s);else{let o=this.assignments;this.assignments=t,a&&i!==i?this.createObjectAssign(e.i,r,s):this.createArrayAssign(e.i,a?r:'"'+r+'"',s),this.assignments=o}}serializeAssignment(e,t,r,n){if(typeof r=="string")this.serializeStringKeyAssignment(e,t,r,n);else{let s=this.stack;this.stack=[];let i=this.serialize(n);this.stack=s;let a=this.assignments;this.assignments=t,this.createArrayAssign(e.i,this.serialize(r),i),this.assignments=a}}serializeAssignments(e,t){let r=t.s;if(r){let n=[],s=t.k,i=t.v;this.stack.push(e.i);for(let a=0;a<r;a++)this.serializeAssignment(e,n,s[a],i[a]);return this.stack.pop(),dt(n)}}serializeDictionary(e,t){if(e.p)if(this.features&8)t=this.serializeWithObjectAssign(e,e.p,t);else{this.markRef(e.i);let r=this.serializeAssignments(e,e.p);if(r)return"("+this.assignIndexedValue(e.i,t)+","+r+this.getRefParam(e.i)+")"}return this.assignIndexedValue(e.i,t)}serializeNullConstructor(e){return this.pushObjectFlag(e.o,e.i),this.serializeDictionary(e,Yn)}serializeDate(e){return this.assignIndexedValue(e.i,'new Date("'+e.s+'")')}serializeRegExp(e){return this.assignIndexedValue(e.i,"/"+e.c+"/"+e.m)}serializeSetItem(e,t){return this.isIndexedValueInStack(t)?(this.markRef(e),this.createAddAssignment(e,this.getRefParam(t.i)),""):this.serialize(t)}serializeSet(e){let t=Zn,r=e.l,n=e.i;if(r){let s=e.a;this.stack.push(n);let i=this.serializeSetItem(n,s[0]);for(let a=1,o=i;a<r;a++)o=this.serializeSetItem(n,s[a]),i+=(o&&i&&",")+o;this.stack.pop(),i&&(t+="(["+i+"])")}return this.assignIndexedValue(n,t)}serializeMapEntry(e,t,r,n){if(this.isIndexedValueInStack(t)){let s=this.getRefParam(t.i);if(this.markRef(e),this.isIndexedValueInStack(r)){let a=this.getRefParam(r.i);return this.createSetAssignment(e,s,a),""}if(r.t!==4&&r.i!=null&&this.isMarked(r.i)){let a="("+this.serialize(r)+",["+n+","+n+"])";return this.createSetAssignment(e,s,this.getRefParam(r.i)),this.createDeleteAssignment(e,n),a}let i=this.stack;return this.stack=[],this.createSetAssignment(e,s,this.serialize(r)),this.stack=i,""}if(this.isIndexedValueInStack(r)){let s=this.getRefParam(r.i);if(this.markRef(e),t.t!==4&&t.i!=null&&this.isMarked(t.i)){let a="("+this.serialize(t)+",["+n+","+n+"])";return this.createSetAssignment(e,this.getRefParam(t.i),s),this.createDeleteAssignment(e,n),a}let i=this.stack;return this.stack=[],this.createSetAssignment(e,this.serialize(t),s),this.stack=i,""}return"["+this.serialize(t)+","+this.serialize(r)+"]"}serializeMap(e){let t=Qn,r=e.e.s,n=e.i,s=e.f,i=this.getRefParam(s.i);if(r){let a=e.e.k,o=e.e.v;this.stack.push(n);let l=this.serializeMapEntry(n,a[0],o[0],i);for(let u=1,c=l;u<r;u++)c=this.serializeMapEntry(n,a[u],o[u],i),l+=(c&&l&&",")+c;this.stack.pop(),l&&(t+="(["+l+"])")}return s.t===26&&(this.markRef(s.i),t="("+this.serialize(s)+","+t+")"),this.assignIndexedValue(n,t)}serializeArrayBuffer(e){let t="new Uint8Array(",r=e.s,n=r.length;if(n){t+="["+r[0];for(let s=1;s<n;s++)t+=","+r[s];t+="]"}return this.assignIndexedValue(e.i,t+").buffer")}serializeTypedArray(e){return this.assignIndexedValue(e.i,"new "+e.c+"("+this.serialize(e.f)+","+e.b+","+e.l+")")}serializeDataView(e){return this.assignIndexedValue(e.i,"new DataView("+this.serialize(e.f)+","+e.b+","+e.l+")")}serializeAggregateError(e){let t=e.i;this.stack.push(t);let r=this.serializeDictionary(e,'new AggregateError([],"'+e.m+'")');return this.stack.pop(),r}serializeError(e){return this.serializeDictionary(e,"new "+Tt[e.s]+'("'+e.m+'")')}serializePromise(e){let t,r=e.f,n=e.i,s=e.s?es:ts;if(this.isIndexedValueInStack(r)){let i=this.getRefParam(r.i);t=s+(e.s?"().then("+this.createFunction([],i)+")":"().catch("+this.createEffectfulFunction([],"throw "+i)+")")}else{this.stack.push(n);let i=this.serialize(r);this.stack.pop(),t=s+"("+i+")"}return this.assignIndexedValue(n,t)}serializeWellKnownSymbol(e){return this.assignIndexedValue(e.i,en[e.s])}serializeBoxed(e){return this.assignIndexedValue(e.i,"Object("+this.serialize(e.f)+")")}serializePlugin(e){let t=this.plugins;if(t)for(let r=0,n=t.length;r<n;r++){let s=t[r];if(s.tag===e.c)return this.assignIndexedValue(e.i,s.serialize(e.s,this,{id:e.i}))}throw new Vt(e.c)}getConstructor(e){let t=this.serialize(e);return t===this.getRefParam(e.i)?t:"("+t+")"}serializePromiseConstructor(e){return this.assignIndexedValue(e.i,this.getConstructor(e.f)+"()")}serializePromiseResolve(e){return this.getConstructor(e.a[0])+"("+this.getRefParam(e.i)+","+this.serialize(e.a[1])+")"}serializePromiseReject(e){return this.getConstructor(e.a[0])+"("+this.getRefParam(e.i)+","+this.serialize(e.a[1])+")"}serializeSpecialReferenceValue(e){switch(e){case 0:return"[]";case 1:return this.createFunction(["s","f","p"],"((p=new Promise("+this.createEffectfulFunction(["a","b"],"s=a,f=b")+")).s=s,p.f=f,p)");case 2:return this.createEffectfulFunction(["p","d"],'p.s(d),p.status="success",p.value=d;delete p.s;delete p.f');case 3:return this.createEffectfulFunction(["p","d"],'p.f(d),p.status="failure",p.value=d;delete p.s;delete p.f');case 4:return this.createFunction(["b","a","s","l","p","f","e","n"],"(b=[],a=!0,s=!1,l=[],p=0,f="+this.createEffectfulFunction(["v","m","x"],"for(x=0;x<p;x++)l[x]&&l[x][m](v)")+",n="+this.createEffectfulFunction(["o","x","z","c"],'for(x=0,z=b.length;x<z;x++)(c=b[x],x===z-1?o[s?"return":"throw"](c):o.next(c))')+",e="+this.createFunction(["o","t"],"(a&&(l[t=p++]=o),n(o),"+this.createEffectfulFunction([],"a&&(l[t]=void 0)")+")")+",{__SEROVAL_STREAM__:!0,on:"+this.createFunction(["o"],"e(o)")+",next:"+this.createEffectfulFunction(["v"],'a&&(b.push(v),f(v,"next"))')+",throw:"+this.createEffectfulFunction(["v"],'a&&(b.push(v),f(v,"throw"),a=s=!1,l.length=0)')+",return:"+this.createEffectfulFunction(["v"],'a&&(b.push(v),f(v,"return"),a=!1,s=!0,l.length=0)')+"})");default:return""}}serializeSpecialReference(e){return this.assignIndexedValue(e.i,this.serializeSpecialReferenceValue(e.s))}serializeIteratorFactory(e){let t="",r=!1;return e.f.t!==4&&(this.markRef(e.f.i),t="("+this.serialize(e.f)+",",r=!0),t+=this.assignIndexedValue(e.i,this.createFunction(["s"],this.createFunction(["i","c","d","t"],"(i=0,t={["+this.getRefParam(e.f.i)+"]:"+this.createFunction([],"t")+",next:"+this.createEffectfulFunction([],"if(i>s.d)return{done:!0,value:void 0};if(d=s.v[c=i++],c===s.t)throw d;return{done:c===s.d,value:d}")+"})"))),r&&(t+=")"),t}serializeIteratorFactoryInstance(e){return this.getConstructor(e.a[0])+"("+this.serialize(e.a[1])+")"}serializeAsyncIteratorFactory(e){let t=e.a[0],r=e.a[1],n="";t.t!==4&&(this.markRef(t.i),n+="("+this.serialize(t)),r.t!==4&&(this.markRef(r.i),n+=(n?",":"(")+this.serialize(r)),n&&(n+=",");let s=this.assignIndexedValue(e.i,this.createFunction(["s"],this.createFunction(["b","c","p","d","e","t","f"],"(b=[],c=0,p=[],d=-1,e=!1,f="+this.createEffectfulFunction(["i","l"],"for(i=0,l=p.length;i<l;i++)p[i].s({done:!0,value:void 0})")+",s.on({next:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.s({done:!1,value:v});b.push(v)")+",throw:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.f(v);f(),d=b.length,e=!0,b.push(v)")+",return:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.s({done:!0,value:v});f(),d=b.length,b.push(v)")+"}),t={["+this.getRefParam(r.i)+"]:"+this.createFunction([],"t")+",next:"+this.createEffectfulFunction(["i","t","v"],"if(d===-1){return((i=c++)>=b.length)?(p.push(t="+this.getRefParam(t.i)+"()),t):{done:!0,value:b[i]}}if(c>d)return{done:!0,value:void 0};if(v=b[i=c++],i!==d)return{done:!1,value:v};if(e)throw v;return{done:!0,value:v}")+"})")));return n?n+s+")":s}serializeAsyncIteratorFactoryInstance(e){return this.getConstructor(e.a[0])+"("+this.serialize(e.a[1])+")"}serializeStreamConstructor(e){let t=this.assignIndexedValue(e.i,this.getConstructor(e.f)+"()"),r=e.a.length;if(r){let n=this.serialize(e.a[0]);for(let s=1;s<r;s++)n+=","+this.serialize(e.a[s]);return"("+t+","+n+","+this.getRefParam(e.i)+")"}return t}serializeStreamNext(e){return this.getRefParam(e.i)+".next("+this.serialize(e.f)+")"}serializeStreamThrow(e){return this.getRefParam(e.i)+".throw("+this.serialize(e.f)+")"}serializeStreamReturn(e){return this.getRefParam(e.i)+".return("+this.serialize(e.f)+")"}serialize(e){try{switch(e.t){case 2:return rn[e.s];case 0:return""+e.s;case 1:return'"'+e.s+'"';case 3:return e.s+"n";case 4:return this.getRefParam(e.i);case 18:return this.serializeReference(e);case 9:return this.serializeArray(e);case 10:return this.serializeObject(e);case 11:return this.serializeNullConstructor(e);case 5:return this.serializeDate(e);case 6:return this.serializeRegExp(e);case 7:return this.serializeSet(e);case 8:return this.serializeMap(e);case 19:return this.serializeArrayBuffer(e);case 16:case 15:return this.serializeTypedArray(e);case 20:return this.serializeDataView(e);case 14:return this.serializeAggregateError(e);case 13:return this.serializeError(e);case 12:return this.serializePromise(e);case 17:return this.serializeWellKnownSymbol(e);case 21:return this.serializeBoxed(e);case 22:return this.serializePromiseConstructor(e);case 23:return this.serializePromiseResolve(e);case 24:return this.serializePromiseReject(e);case 25:return this.serializePlugin(e);case 26:return this.serializeSpecialReference(e);case 27:return this.serializeIteratorFactory(e);case 28:return this.serializeIteratorFactoryInstance(e);case 29:return this.serializeAsyncIteratorFactory(e);case 30:return this.serializeAsyncIteratorFactoryInstance(e);case 31:return this.serializeStreamConstructor(e);case 32:return this.serializeStreamNext(e);case 33:return this.serializeStreamThrow(e);case 34:return this.serializeStreamReturn(e);default:throw new Mt(e)}}catch(t){throw new jn(t)}}},ss=class extends Un{parseItems(t){let r=[];for(let n=0,s=t.length;n<s;n++)n in t&&(r[n]=this.parse(t[n]));return r}parseArray(t,r){return wn(t,r,this.parseItems(r))}parseProperties(t){let r=Object.entries(t),n=[],s=[];for(let a=0,o=r.length;a<o;a++)n.push(O(r[a][0])),s.push(this.parse(r[a][1]));let i=Symbol.iterator;return i in t&&(n.push(this.parseWellKnownSymbol(i)),s.push(Nt(this.parseIteratorFactory(),this.parse(Dt(t))))),i=Symbol.asyncIterator,i in t&&(n.push(this.parseWellKnownSymbol(i)),s.push(jt(this.parseAsyncIteratorFactory(),this.parse(se())))),i=Symbol.toStringTag,i in t&&(n.push(this.parseWellKnownSymbol(i)),s.push(je(t[i]))),i=Symbol.isConcatSpreadable,i in t&&(n.push(this.parseWellKnownSymbol(i)),s.push(t[i]?_e:Ne)),{k:n,v:s,s:n.length}}parsePlainObject(t,r,n){return this.createObjectNode(t,r,n,this.parseProperties(r))}parseBoxed(t,r){return Sn(t,this.parse(r.valueOf()))}parseTypedArray(t,r){return zn(t,r,this.parse(r.buffer))}parseBigIntTypedArray(t,r){return En(t,r,this.parse(r.buffer))}parseDataView(t,r){return Rn(t,r,this.parse(r.buffer))}parseError(t,r){let n=ot(r,this.features);return In(t,r,n?this.parseProperties(n):void 0)}parseAggregateError(t,r){let n=ot(r,this.features);return An(t,r,n?this.parseProperties(n):void 0)}parseMap(t,r){let n=[],s=[];for(let[i,a]of r.entries())n.push(this.parse(i)),s.push(this.parse(a));return this.createMapNode(t,n,s,r.size)}parseSet(t,r){let n=[];for(let s of r.keys())n.push(this.parse(s));return xn(t,r.size,n)}parsePlugin(t,r){let n=this.plugins;if(n)for(let s=0,i=n.length;s<i;s++){let a=n[s];if(a.parse.sync&&a.test(r))return _t(t,a.tag,a.parse.sync(r,this,{id:t}))}}parseStream(t,r){return Lt(t,this.parseSpecialReference(4),[])}parsePromise(t,r){return this.createPromiseConstructorNode(t)}parseObject(t,r){if(Array.isArray(r))return this.parseArray(t,r);if(Bn(r))return this.parseStream(t,r);let n=this.parsePlugin(t,r);if(n)return n;let s=r.constructor;switch(s){case Object:return this.parsePlainObject(t,r,!1);case void 0:return this.parsePlainObject(t,r,!0);case Date:return gn(t,r);case RegExp:return vn(t,r);case Error:case EvalError:case RangeError:case ReferenceError:case SyntaxError:case TypeError:case URIError:return this.parseError(t,r);case Number:case Boolean:case String:case BigInt:return this.parseBoxed(t,r);case ArrayBuffer:return yn(t,r);case Int8Array:case Int16Array:case Int32Array:case Uint8Array:case Uint16Array:case Uint32Array:case Uint8ClampedArray:case Float32Array:case Float64Array:return this.parseTypedArray(t,r);case DataView:return this.parseDataView(t,r);case Map:return this.parseMap(t,r);case Set:return this.parseSet(t,r)}if(s===Promise||r instanceof Promise)return this.parsePromise(t,r);let i=this.features;if(i&16)switch(s){case BigInt64Array:case BigUint64Array:return this.parseBigIntTypedArray(t,r)}if(i&1&&typeof AggregateError<"u"&&(s===AggregateError||r instanceof AggregateError))return this.parseAggregateError(t,r);if(r instanceof Error)return this.parseError(t,r);if(Symbol.iterator in r||Symbol.asyncIterator in r)return this.parsePlainObject(t,r,!!s);throw new ge(r)}parse(t){try{switch(typeof t){case"boolean":return t?_e:Ne;case"undefined":return an;case"string":return je(t);case"number":return fn(t);case"bigint":return pn(t);case"object":{if(t){let r=this.getReference(t);return r.type===0?this.parseObject(r.value,t):r.value}return on}case"symbol":return this.parseWellKnownSymbol(t);case"function":return this.parseFunction(t);default:throw new ge(t)}}catch(r){throw new Nn(r)}}};function is(e,t={}){let r=Ot(t.plugins);return new Xn({plugins:r,markedRefs:e.m}).deserialize(e.t)}var as=class extends ns{constructor(t){super(t),this.mode="cross",this.scopeId=t.scopeId}getRefParam(t){return fe+"["+t+"]"}assignIndexedValue(t,r){return this.getRefParam(t)+"="+r}serializeTop(t){let r=this.serialize(t),n=t.i;if(n==null)return r;let s=this.resolvePatches(),i=this.getRefParam(n),a=this.scopeId==null?"":fe,o=s?r+","+s+i:r;if(a==="")return s?"("+o+")":o;let l=this.scopeId==null?"()":"("+fe+'["'+O(this.scopeId)+'"])';return"("+this.createFunction([a],o)+")"+l}},os=class extends ss{constructor(t){super(t),this.alive=!0,this.pending=0,this.initial=!0,this.buffer=[],this.onParseCallback=t.onParse,this.onErrorCallback=t.onError,this.onDoneCallback=t.onDone}onParseInternal(t,r){try{this.onParseCallback(t,r)}catch(n){this.onError(n)}}flush(){for(let t=0,r=this.buffer.length;t<r;t++)this.onParseInternal(this.buffer[t],!1)}onParse(t){this.initial?this.buffer.push(t):this.onParseInternal(t,!1)}onError(t){if(this.onErrorCallback)this.onErrorCallback(t);else throw t}onDone(){this.onDoneCallback&&this.onDoneCallback()}pushPendingState(){this.pending++}popPendingState(){--this.pending<=0&&this.onDone()}parseProperties(t){let r=Object.entries(t),n=[],s=[];for(let a=0,o=r.length;a<o;a++)n.push(O(r[a][0])),s.push(this.parse(r[a][1]));let i=Symbol.iterator;return i in t&&(n.push(this.parseWellKnownSymbol(i)),s.push(Nt(this.parseIteratorFactory(),this.parse(Dt(t))))),i=Symbol.asyncIterator,i in t&&(n.push(this.parseWellKnownSymbol(i)),s.push(jt(this.parseAsyncIteratorFactory(),this.parse(qn(t))))),i=Symbol.toStringTag,i in t&&(n.push(this.parseWellKnownSymbol(i)),s.push(je(t[i]))),i=Symbol.isConcatSpreadable,i in t&&(n.push(this.parseWellKnownSymbol(i)),s.push(t[i]?_e:Ne)),{k:n,v:s,s:n.length}}parsePromise(t,r){return r.then(n=>{let s=this.parseWithError(n);s&&this.onParse({t:23,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[this.parseSpecialReference(2),s],f:void 0,b:void 0,o:void 0}),this.popPendingState()},n=>{if(this.alive){let s=this.parseWithError(n);s&&this.onParse({t:24,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[this.parseSpecialReference(3),s],f:void 0,b:void 0,o:void 0})}this.popPendingState()}),this.pushPendingState(),this.createPromiseConstructorNode(t)}parsePlugin(t,r){let n=this.plugins;if(n)for(let s=0,i=n.length;s<i;s++){let a=n[s];if(a.parse.stream&&a.test(r))return _t(t,a.tag,a.parse.stream(r,this,{id:t}))}}parseStream(t,r){let n=Lt(t,this.parseSpecialReference(4),[]);return this.pushPendingState(),r.on({next:s=>{if(this.alive){let i=this.parseWithError(s);i&&this.onParse(Pn(t,i))}},throw:s=>{if(this.alive){let i=this.parseWithError(s);i&&this.onParse($n(t,i))}this.popPendingState()},return:s=>{if(this.alive){let i=this.parseWithError(s);i&&this.onParse(kn(t,i))}this.popPendingState()}}),n}parseWithError(t){try{return this.parse(t)}catch(r){this.onError(r);return}}start(t){let r=this.parseWithError(t);r&&(this.onParseInternal(r,!0),this.initial=!1,this.flush(),this.pending<=0&&this.destroy())}destroy(){this.alive&&(this.onDone(),this.alive=!1)}isAlive(){return this.alive}},ls=class extends os{constructor(){super(...arguments),this.mode="cross"}};function cs(e,t){let r=Ot(t.plugins),n=new ls({plugins:r,refs:t.refs,disabledFeatures:t.disabledFeatures,onParse(s,i){let a=new as({plugins:r,features:n.features,scopeId:t.scopeId,markedRefs:n.marked}),o;try{o=a.serializeTop(s)}catch(l){t.onError&&t.onError(l);return}t.onSerialize(o,i)},onError:t.onError,onDone:t.onDone});return n.start(e),()=>{n.destroy()}}function xe(e){return{detail:e.detail,bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed}}var us={tag:"seroval-plugins/web/CustomEvent",test(e){return typeof CustomEvent>"u"?!1:e instanceof CustomEvent},parse:{sync(e,t){return{type:t.parse(e.type),options:t.parse(xe(e))}},async async(e,t){return{type:await t.parse(e.type),options:await t.parse(xe(e))}},stream(e,t){return{type:t.parse(e.type),options:t.parse(xe(e))}}},serialize(e,t){return"new CustomEvent("+t.serialize(e.type)+","+t.serialize(e.options)+")"},deserialize(e,t){return new CustomEvent(t.deserialize(e.type),t.deserialize(e.options))}},Ut=us,ds={tag:"seroval-plugins/web/DOMException",test(e){return typeof DOMException>"u"?!1:e instanceof DOMException},parse:{sync(e,t){return{name:t.parse(e.name),message:t.parse(e.message)}},async async(e,t){return{name:await t.parse(e.name),message:await t.parse(e.message)}},stream(e,t){return{name:t.parse(e.name),message:t.parse(e.message)}}},serialize(e,t){return"new DOMException("+t.serialize(e.message)+","+t.serialize(e.name)+")"},deserialize(e,t){return new DOMException(t.deserialize(e.message),t.deserialize(e.name))}},Bt=ds;function Pe(e){return{bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed}}var hs={tag:"seroval-plugins/web/Event",test(e){return typeof Event>"u"?!1:e instanceof Event},parse:{sync(e,t){return{type:t.parse(e.type),options:t.parse(Pe(e))}},async async(e,t){return{type:await t.parse(e.type),options:await t.parse(Pe(e))}},stream(e,t){return{type:t.parse(e.type),options:t.parse(Pe(e))}}},serialize(e,t){return"new Event("+t.serialize(e.type)+","+t.serialize(e.options)+")"},deserialize(e,t){return new Event(t.deserialize(e.type),t.deserialize(e.options))}},qt=hs,fs={tag:"seroval-plugins/web/File",test(e){return typeof File>"u"?!1:e instanceof File},parse:{async async(e,t){return{name:await t.parse(e.name),options:await t.parse({type:e.type,lastModified:e.lastModified}),buffer:await t.parse(await e.arrayBuffer())}}},serialize(e,t){return"new File(["+t.serialize(e.buffer)+"],"+t.serialize(e.name)+","+t.serialize(e.options)+")"},deserialize(e,t){return new File([t.deserialize(e.buffer)],t.deserialize(e.name),t.deserialize(e.options))}},ps=fs;function $e(e){let t=[];return e.forEach((r,n)=>{t.push([n,r])}),t}var Z={},ms={tag:"seroval-plugins/web/FormDataFactory",test(e){return e===Z},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(e,t){return t.createEffectfulFunction(["e","f","i","s","t"],"f=new FormData;for(i=0,s=e.length;i<s;i++)f.append((t=e[i])[0],t[1]);return f")},deserialize(){return Z}},gs={tag:"seroval-plugins/web/FormData",extends:[ps,ms],test(e){return typeof FormData>"u"?!1:e instanceof FormData},parse:{sync(e,t){return{factory:t.parse(Z),entries:t.parse($e(e))}},async async(e,t){return{factory:await t.parse(Z),entries:await t.parse($e(e))}},stream(e,t){return{factory:t.parse(Z),entries:t.parse($e(e))}}},serialize(e,t){return"("+t.serialize(e.factory)+")("+t.serialize(e.entries)+")"},deserialize(e,t){let r=new FormData,n=t.deserialize(e.entries);for(let s=0,i=n.length;s<i;s++){let a=n[s];r.append(a[0],a[1])}return r}},Wt=gs;function ke(e){let t=[];return e.forEach((r,n)=>{t.push([n,r])}),t}var vs={tag:"seroval-plugins/web/Headers",test(e){return typeof Headers>"u"?!1:e instanceof Headers},parse:{sync(e,t){return t.parse(ke(e))},async async(e,t){return await t.parse(ke(e))},stream(e,t){return t.parse(ke(e))}},serialize(e,t){return"new Headers("+t.serialize(e)+")"},deserialize(e,t){return new Headers(t.deserialize(e))}},we=vs,Q={},ys={tag:"seroval-plugins/web/ReadableStreamFactory",test(e){return e===Q},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(e,t){return t.createFunction(["d"],"new ReadableStream({start:"+t.createEffectfulFunction(["c"],"d.on({next:"+t.createEffectfulFunction(["v"],"c.enqueue(v)")+",throw:"+t.createEffectfulFunction(["v"],"c.error(v)")+",return:"+t.createEffectfulFunction([],"c.close()")+"})")+"})")},deserialize(){return Q}};function ht(e){let t=se(),r=e.getReader();async function n(){try{let s=await r.read();s.done?t.return(s.value):(t.next(s.value),await n())}catch(s){t.throw(s)}}return n().catch(()=>{}),t}var bs={tag:"seroval/plugins/web/ReadableStream",extends:[ys],test(e){return typeof ReadableStream>"u"?!1:e instanceof ReadableStream},parse:{sync(e,t){return{factory:t.parse(Q),stream:t.parse(se())}},async async(e,t){return{factory:await t.parse(Q),stream:await t.parse(ht(e))}},stream(e,t){return{factory:t.parse(Q),stream:t.parse(ht(e))}}},serialize(e,t){return"("+t.serialize(e.factory)+")("+t.serialize(e.stream)+")"},deserialize(e,t){let r=t.deserialize(e.stream);return new ReadableStream({start(n){r.on({next(s){n.enqueue(s)},throw(s){n.error(s)},return(){n.close()}})}})}},Se=bs;function ft(e,t){return{body:t,cache:e.cache,credentials:e.credentials,headers:e.headers,integrity:e.integrity,keepalive:e.keepalive,method:e.method,mode:e.mode,redirect:e.redirect,referrer:e.referrer,referrerPolicy:e.referrerPolicy}}var ws={tag:"seroval-plugins/web/Request",extends:[Se,we],test(e){return typeof Request>"u"?!1:e instanceof Request},parse:{async async(e,t){return{url:await t.parse(e.url),options:await t.parse(ft(e,e.body?await e.clone().arrayBuffer():null))}},stream(e,t){return{url:t.parse(e.url),options:t.parse(ft(e,e.clone().body))}}},serialize(e,t){return"new Request("+t.serialize(e.url)+","+t.serialize(e.options)+")"},deserialize(e,t){return new Request(t.deserialize(e.url),t.deserialize(e.options))}},Ht=ws;function pt(e){return{headers:e.headers,status:e.status,statusText:e.statusText}}var Ss={tag:"seroval-plugins/web/Response",extends:[Se,we],test(e){return typeof Response>"u"?!1:e instanceof Response},parse:{async async(e,t){return{body:await t.parse(e.body?await e.clone().arrayBuffer():null),options:await t.parse(pt(e))}},stream(e,t){return{body:t.parse(e.clone().body),options:t.parse(pt(e))}}},serialize(e,t){return"new Response("+t.serialize(e.body)+","+t.serialize(e.options)+")"},deserialize(e,t){return new Response(t.deserialize(e.body),t.deserialize(e.options))}},Kt=Ss,zs={tag:"seroval-plugins/web/URLSearchParams",test(e){return typeof URLSearchParams>"u"?!1:e instanceof URLSearchParams},parse:{sync(e,t){return t.parse(e.toString())},async async(e,t){return await t.parse(e.toString())},stream(e,t){return t.parse(e.toString())}},serialize(e,t){return"new URLSearchParams("+t.serialize(e)+")"},deserialize(e,t){return new URLSearchParams(t.deserialize(e))}},Xt=zs,Es={tag:"seroval-plugins/web/URL",test(e){return typeof URL>"u"?!1:e instanceof URL},parse:{sync(e,t){return t.parse(e.href)},async async(e,t){return await t.parse(e.href)},stream(e,t){return t.parse(e.href)}},serialize(e,t){return"new URL("+t.serialize(e)+")"},deserialize(e,t){return new URL(t.deserialize(e))}},Gt=Es;const Oe="Invariant Violation",{setPrototypeOf:Rs=function(e,t){return e.__proto__=t,e}}=Object;class Ye extends Error{framesToPop=1;name=Oe;constructor(t=Oe){super(typeof t=="number"?`${Oe}: ${t} (see https://github.com/apollographql/invariant-packages)`:t),Rs(this,Ye.prototype)}}function Is(e,t){if(!e)throw new Ye(t)}function As(e){e.forEach(t=>{if(!t.attrs.href)return;let r=document.head.querySelector(`link[href="${t.attrs.href}"]`);r||(r=document.createElement("link"),r.setAttribute("rel","preload"),r.setAttribute("as","style"),r.setAttribute("href",t.attrs.href),document.head.appendChild(r))})}var xs=" ";const Ps={style:e=>Ae("style",e.attrs,()=>m(e.children),!0),link:e=>Ae("link",e.attrs,void 0,!0),script:e=>e.attrs.src?Ae("script",kr(()=>e.attrs,{get id(){return e.key}}),()=>E(xs),!0):null};function $s(e){let{tag:t,attrs:{key:r,...n}={key:void 0},children:s}=e;return Ps[t]({attrs:n,key:r,children:s})}function ks(e,t,r,n="default"){return Ir(async()=>{{const i=(await e.import())[n],o=(await t.inputs?.[e.src].assets()).filter(u=>u.tag==="style"||u.attrs.rel==="stylesheet");return typeof window<"u"&&As(o),{default:u=>[...o.map(c=>$s(c)),zt(i,u)]}}})}const q={NORMAL:0,WILDCARD:1,PLACEHOLDER:2};function Os(e={}){const t={options:e,rootNode:Jt(),staticRoutesMap:{}},r=n=>e.strictTrailingSlash?n:n.replace(/\/$/,"")||"/";if(e.routes)for(const n in e.routes)mt(t,r(n),e.routes[n]);return{ctx:t,lookup:n=>Fs(t,r(n)),insert:(n,s)=>mt(t,r(n),s),remove:n=>Ts(t,r(n))}}function Fs(e,t){const r=e.staticRoutesMap[t];if(r)return r.data;const n=t.split("/"),s={};let i=!1,a=null,o=e.rootNode,l=null;for(let u=0;u<n.length;u++){const c=n[u];o.wildcardChildNode!==null&&(a=o.wildcardChildNode,l=n.slice(u).join("/"));const d=o.children.get(c);if(d!==void 0)o=d;else if(o=o.placeholderChildNode,o!==null)s[o.paramName]=c,i=!0;else break}return(o===null||o.data===null)&&a!==null&&(o=a,s[o.paramName||"_"]=l,i=!0),o?i?{...o.data,params:i?s:void 0}:o.data:null}function mt(e,t,r){let n=!0;const s=t.split("/");let i=e.rootNode,a=0;for(const o of s){let l;if(l=i.children.get(o))i=l;else{const u=Cs(o);l=Jt({type:u,parent:i}),i.children.set(o,l),u===q.PLACEHOLDER?(l.paramName=o==="*"?`_${a++}`:o.slice(1),i.placeholderChildNode=l,n=!1):u===q.WILDCARD&&(i.wildcardChildNode=l,l.paramName=o.slice(3)||"_",n=!1),i=l}}return i.data=r,n===!0&&(e.staticRoutesMap[t]=i),i}function Ts(e,t){let r=!1;const n=t.split("/");let s=e.rootNode;for(const i of n)if(s=s.children.get(i),!s)return r;if(s.data){const i=n[n.length-1];if(s.data=null,Object.keys(s.children).length===0){const a=s.parent;a.children.delete(i),a.wildcardChildNode=null,a.placeholderChildNode=null}r=!0}return r}function Jt(e={}){return{type:e.type||q.NORMAL,parent:e.parent||null,children:new Map,data:e.data||null,paramName:e.paramName||null,wildcardChildNode:null,placeholderChildNode:null}}function Cs(e){return e.startsWith("**")?q.WILDCARD:e[0]===":"||e==="*"?q.PLACEHOLDER:q.NORMAL}const Yt=[],_s=Ns(Yt.filter(e=>e.$component));function Ns(e){function t(r,n,s,i){const a=Object.values(r).find(o=>s.startsWith(o.id+"/"));return a?(t(a.children||(a.children=[]),n,s.slice(a.id.length)),r):(r.push({...n,id:s,path:s.replace(/\/\([^)/]+\)/g,"")}),r)}return e.sort((r,n)=>r.path.length-n.path.length).reduce((r,n)=>t(r,n,n.path,n.path),[])}function js(e){return e.$GET||e.$POST||e.$PUT||e.$PATCH||e.$DELETE}Os({routes:Yt.reduce((e,t)=>{if(!js(t))return e;let r=t.path.replace(/\(.*\)\/?/g,"").replace(/\*([^/]*)/g,(n,s)=>`**:${s}`);if(/:[^/]*\?/g.test(r))throw new Error(`Optional parameters are not supported in API routes: ${r}`);if(e[r])throw new Error(`Duplicate API routes for "${r}" found at "${e[r].route.path}" and "${t.path}"`);return e[r]={route:t},e},{})});function Ls(){function e(r){return{...r,...r.$$route?r.$$route.require().route:void 0,info:{...r.$$route?r.$$route.require().route.info:{},filesystem:!0},component:ks(r.$component,globalThis.MANIFEST.client,globalThis.MANIFEST.ssr),children:r.children?r.children.map(e):void 0}}return _s.map(e)}function Ds(e){const t=Cr(e,"flash");if(!t)return;let r=JSON.parse(t);if(!r||!r.result)return[];const n=[...r.input.slice(0,-1),new Map(r.input[r.input.length-1])];return _r(e,"flash","",{maxAge:0}),{url:r.url,result:r.error?new Error(r.result):r.result,input:n}}async function Ms(e){const t=globalThis.MANIFEST.client;return globalThis.MANIFEST.ssr,e.response.headers.set("Content-Type","text/html"),Object.assign(e,{manifest:await t.json(),assets:[...await t.inputs[t.handler].assets()],router:{submission:Ds(e)},routes:Ls(),$islands:new Set})}function Zt(){let e=new Set;function t(s){return e.add(s),()=>e.delete(s)}let r=!1;function n(s,i){if(r)return!(r=!1);const a={to:s,options:i,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const o of e)o.listener({...a,from:o.location,retry:l=>{l&&(r=!0),o.navigate(s,{...i,resolve:!1})}});return!a.defaultPrevented}return{subscribe:t,confirm:n}}let De;function Ze(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),De=window.history.state._depth}w||Ze();function Vs(e){return{...e,_depth:window.history.state&&window.history.state._depth}}function Us(e,t){let r=!1;return()=>{const n=De;Ze();const s=n==null?null:De-n;if(r){r=!1;return}s&&t(s)?(r=!0,window.history.go(-s)):e()}}const Bs=/^(?:[a-z0-9]+:)?\/\//i,qs=/^\/+|(\/)\/+$/g,Qe="http://sr";function ee(e,t=!1){const r=e.replace(qs,"$1");return r?t||/^[?#]/.test(r)?r:"/"+r:""}function pe(e,t,r){if(Bs.test(t))return;const n=ee(e),s=r&&ee(r);let i="";return!s||t.startsWith("/")?i=n:s.toLowerCase().indexOf(n.toLowerCase())!==0?i=n+s:i=s,(i||"/")+ee(t,!i)}function Ws(e,t){if(e==null)throw new Error(t);return e}function Hs(e,t){return ee(e).replace(/\/*(\*.*)?$/g,"")+ee(t)}function et(e){const t={};return e.searchParams.forEach((r,n)=>{t[n]=r}),t}function Ks(e,t,r){const[n,s]=e.split("/*",2),i=n.split("/").filter(Boolean),a=i.length;return o=>{const l=o.split("/").filter(Boolean),u=l.length-a;if(u<0||u>0&&s===void 0&&!t)return null;const c={path:a?"":"/",params:{}},d=p=>r===void 0?void 0:r[p];for(let p=0;p<a;p++){const y=i[p],h=l[p],f=y[0]===":",v=f?y.slice(1):y;if(f&&Fe(h,d(v)))c.params[v]=h;else if(f||!Fe(h,y))return null;c.path+=`/${h}`}if(s){const p=u?l.slice(-u).join("/"):"";if(Fe(p,d(s)))c.params[s]=p;else return null}return c}}function Fe(e,t){const r=n=>n.localeCompare(e,void 0,{sensitivity:"base"})===0;return t===void 0?!0:typeof t=="string"?r(t):typeof t=="function"?t(e):Array.isArray(t)?t.some(r):t instanceof RegExp?t.test(e):!1}function Xs(e){const[t,r]=e.pattern.split("/*",2),n=t.split("/").filter(Boolean);return n.reduce((s,i)=>s+(i.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function Qt(e){const t=new Map,r=re();return new Proxy({},{get(n,s){return t.has(s)||Et(r,()=>t.set(s,k(()=>e()[s]))),t.get(s)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(e())}})}function Gs(e,t){const r=new URLSearchParams(e);Object.entries(t).forEach(([s,i])=>{i==null||i===""?r.delete(s):r.set(s,String(i))});const n=r.toString();return n?`?${n}`:""}function er(e){let t=/(\/?\:[^\/]+)\?/.exec(e);if(!t)return[e];let r=e.slice(0,t.index),n=e.slice(t.index+t[0].length);const s=[r,r+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(n);)s.push(r+=t[1]),n=n.slice(t[0].length);return er(n).reduce((i,a)=>[...i,...s.map(o=>o+a)],[])}const Js=100,tr=be(),ze=be(),Ee=()=>Ws(ne(tr),"Make sure your app is wrapped in a <Router />"),Ys=()=>ne(ze)||Ee().base,ie=()=>Ee().navigatorFactory(),Re=()=>Ee().location,Zs=()=>Ee().isRouting,Qs=()=>Ys().params,rr=()=>{const e=Re(),t=ie(),r=(n,s)=>{const i=me(()=>e.pathname+Gs(e.search,n)+e.hash);t(i,{scroll:!1,resolve:!1,...s})};return[e.query,r]};function ei(e,t=""){const{component:r,load:n,children:s,info:i}=e,a=!s||Array.isArray(s)&&!s.length,o={key:e,component:r,load:n,info:i};return nr(e.path).reduce((l,u)=>{for(const c of er(u)){const d=Hs(t,c);let p=a?d:d.split("/*",1)[0];p=p.split("/").map(y=>y.startsWith(":")||y.startsWith("*")?y:encodeURIComponent(y)).join("/"),l.push({...o,originalPath:c,pattern:p,matcher:Ks(p,!a,e.matchFilters)})}return l},[])}function ti(e,t=0){return{routes:e,score:Xs(e[e.length-1])*1e4-t,matcher(r){const n=[];for(let s=e.length-1;s>=0;s--){const i=e[s],a=i.matcher(r);if(!a)return null;n.unshift({...a,route:i})}return n}}}function nr(e){return Array.isArray(e)?e:[e]}function sr(e,t="",r=[],n=[]){const s=nr(e);for(let i=0,a=s.length;i<a;i++){const o=s[i];if(o&&typeof o=="object"){o.hasOwnProperty("path")||(o.path="");const l=ei(o,t);for(const u of l){r.push(u);const c=Array.isArray(o.children)&&o.children.length===0;if(o.children&&!c)sr(o.children,u.pattern,r,n);else{const d=ti([...r],n.length);n.push(d)}r.pop()}}}return r.length?n:n.sort((i,a)=>a.score-i.score)}function ve(e,t){for(let r=0,n=e.length;r<n;r++){const s=e[r].matcher(t);if(s)return s}return[]}function ri(e,t){const r=new URL(Qe),n=k(l=>{const u=e();try{return new URL(u,r)}catch{return console.error(`Invalid path ${u}`),l}},r,{equals:(l,u)=>l.href===u.href}),s=k(()=>n().pathname),i=k(()=>n().search,!0),a=k(()=>n().hash),o=()=>"";return{get pathname(){return s()},get search(){return i()},get hash(){return a()},get state(){return t()},get key(){return o()},query:Qt(It(i,()=>et(n())))}}let T;function ni(){return T}function si(e,t,r,n={}){const{signal:[s,i],utils:a={}}=e,o=a.parsePath||(b=>b),l=a.renderPath||(b=>b),u=a.beforeLeave||Zt(),c=pe("",n.base||"");if(c===void 0)throw new Error(`${c} is not a valid base path`);c&&!s().value&&i({value:c,replace:!0,scroll:!1});const[d,p]=A(!1),y=async b=>{p(!0);try{await Y(b)}finally{p(!1)}},[h,f]=A(s().value),[v,S]=A(s().state),ce=ri(h,v),P=[],N=A(w?Rr():[]),H={pattern:c,params:{},path:()=>c,outlet:()=>null,resolvePath(b){return pe(c,b)}};return Rt(()=>{const{value:b,state:R}=s();me(()=>{b!==h()&&y(()=>{T="native",f(b),S(R),nt(),N[1]([])}).then(()=>{T=void 0})})}),{base:H,location:ce,isRouting:d,renderPath:l,parsePath:o,navigatorFactory:Sr,beforeLeave:u,preloadRoute:Er,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:N};function wr(b,R,L){me(()=>{if(typeof R=="number"){R&&(a.go?a.go(R):console.warn("Router integration does not support relative routing"));return}const{replace:ue,resolve:Ie,scroll:D,state:U}={replace:!1,resolve:!0,scroll:!0,...L},F=Ie?b.resolvePath(R):pe("",R);if(F===void 0)throw new Error(`Path '${R}' is not a routable path`);if(P.length>=Js)throw new Error("Too many redirects");const rt=h();if(F!==rt||U!==v()){if(w){const de=_();de&&(de.response={status:302,headers:new Headers({Location:F})}),i({value:F,replace:ue,scroll:D,state:U})}else if(u.confirm(F,L)){const de=P.push({value:rt,replace:ue,scroll:D,state:v()});y(()=>{T="navigate",f(F),S(U),nt(),N[1]([])}).then(()=>{P.length===de&&(T=void 0,zr({value:F,state:U}))})}}})}function Sr(b){return b=b||ne(ze)||H,(R,L)=>wr(b,R,L)}function zr(b){const R=P[0];R&&((b.value!==R.value||b.state!==R.state)&&i({...b,replace:R.replace,scroll:R.scroll}),P.length=0)}function Er(b,R){const L=ve(r(),b.pathname),ue=T;T="preload";for(let Ie in L){const{route:D,params:U}=L[Ie];D.component&&D.component.preload&&D.component.preload();const{load:F}=D;R&&F&&Et(t(),()=>F({params:U,location:{pathname:b.pathname,search:b.search,hash:b.hash,query:et(b),state:null,key:""},intent:"preload"}))}T=ue}function Rr(){const b=_();return b&&b.router&&b.router.submission?[b.router.submission]:[]}}function ii(e,t,r,n,s){const{base:i,location:a}=e,{pattern:o,component:l,load:u}=n().route,c=k(()=>n().path);l&&l.preload&&l.preload();const d=u?u({params:s,location:a,intent:T||"initial"}):void 0;return{parent:t,pattern:o,path:c,params:s,outlet:()=>l?zt(l,{params:s,location:a,data:d,get children(){return r()}}):r(),resolvePath(y){return pe(i.path(),y,c())}}}const ir=e=>t=>{const{base:r}=t,n=At(()=>t.children),s=k(()=>sr(t.root?{component:t.root,load:t.rootLoad,children:n()}:n(),t.base||""));let i;const a=si(e,()=>i,s,{base:r,singleFlight:t.singleFlight});return e.create&&e.create(a),g(tr.Provider,{value:a,get children(){return[(i=re())&&null,g(ai,{routerState:a,get branches(){return s()}})]}})};function ai(e){const t=k(()=>ve(e.branches,e.routerState.location.pathname));if(w){const a=_();if(a&&a.router&&a.router.dataOnly){li(a,e.branches);return}a&&((a.router||(a.router={})).matches||(a.router.matches=t().map(({route:o,path:l,params:u})=>({path:o.originalPath,pattern:o.pattern,match:l,params:u,info:o.info}))))}const r=Qt(()=>{const a=t(),o={};for(let l=0;l<a.length;l++)Object.assign(o,a[l].params);return o}),n=[];let s;const i=k(It(t,(a,o,l)=>{let u=o&&a.length===o.length;const c=[];for(let d=0,p=a.length;d<p;d++){const y=o&&o[d],h=a[d];l&&y&&h.route.key===y.route.key?c[d]=l[d]:(u=!1,n[d]&&n[d](),Ar(f=>{n[d]=f,c[d]=ii(e.routerState,c[d-1]||e.routerState.base,oi(()=>i()[d+1]),()=>t()[d],r)}))}return n.splice(a.length).forEach(d=>d()),l&&u?l:(s=c[0],c)}));return g(W,{get when(){return i()&&s},keyed:!0,children:a=>g(ze.Provider,{value:a,get children(){return a.outlet()}})})}const oi=e=>()=>g(W,{get when(){return e()},keyed:!0,children:t=>g(ze.Provider,{value:t,get children(){return t.outlet()}})}),X=e=>{const t=At(()=>e.children);return Te(e,{get children(){return t()}})};function li(e,t){const r=new URL(e.request.url),n=ve(t,new URL(e.router.previousUrl||e.request.url).pathname),s=ve(t,r.pathname);for(let i=0;i<s.length;i++){(!n[i]||s[i].route!==n[i].route)&&(e.router.dataOnly=!0);const{route:a,params:o}=s[i];a.load&&a.load({params:o,location:{pathname:r.pathname,search:r.search,hash:r.hash,query:et(r),state:null,key:""},intent:"preload"})}}function ci([e,t],r,n){return[r?()=>r(e()):e,n?s=>t(n(s)):t]}function ui(e){if(e==="#")return null;try{return document.querySelector(e)}catch{return null}}function di(e){let t=!1;const r=s=>typeof s=="string"?{value:s}:s,n=ci(A(r(e.get()),{equals:(s,i)=>s.value===i.value}),void 0,s=>(!t&&e.set(s),s));return e.init&&V(e.init((s=e.get())=>{t=!0,n[1](r(s)),t=!1})),ir({signal:n,create:e.create,utils:e.utils})}function hi(e,t,r){return e.addEventListener(t,r),()=>e.removeEventListener(t,r)}function fi(e,t){const r=ui(`#${e}`);r?r.scrollIntoView():t&&window.scrollTo(0,0)}function pi(e){const t=new URL(e);return t.pathname+t.search}function mi(e){let t;const r={value:e.url||(t=_())&&pi(t.request.url)||""};return ir({signal:[()=>r,n=>Object.assign(r,n)]})(e)}const gi="Location",vi=5e3,yi=18e4;let te=new Map;w||setInterval(()=>{const e=Date.now();for(let[t,r]of te.entries())!r[3].count&&e-r[0]>yi&&te.delete(t)},3e5);function tt(){if(!w)return te;const e=_();if(!e)throw new Error("Cannot find cache context");return(e.router||(e.router={})).cache||(e.router.cache=new Map)}function Me(e,t=!0){return Y(()=>{const r=Date.now();ar(e,n=>{t&&(n[0]=0),n[3][1](r)})})}function ar(e,t){e&&!Array.isArray(e)&&(e=[e]);for(let r of te.keys())(e===void 0||bi(r,e))&&t(te.get(r))}function ae(e,t){e.GET&&(e=e.GET);const r=(...n)=>{const s=tt(),i=ni(),o=re()?ie():void 0,l=Date.now(),u=t+Ve(n);let c=s.get(u),d;if(w){const h=_();if(h){const f=(h.router||(h.router={})).dataOnly;if(f){const v=h&&(h.router.data||(h.router.data={}));if(v&&u in v)return v[u];if(Array.isArray(f)&&!f.includes(u))return v[u]=void 0,Promise.resolve()}}}if(xr()&&!w&&(d=!0,V(()=>c[3].count--)),c&&(w||i==="native"||c[0]&&c[3].count||Date.now()-c[0]<vi)){d&&(c[3].count++,c[3][0]()),c[2]==="preload"&&i!=="preload"&&(c[0]=l);let h=c[1];return i!=="preload"&&(h="then"in c[1]?c[1].then(y(!1),y(!0)):y(!1)(c[1]),!w&&i==="navigate"&&Y(()=>c[3][1](c[0]))),h}let p=!w&&$.context&&$.has(u)?$.load(u):e(...n);if(c?(c[0]=l,c[1]=p,c[2]=i,!w&&i==="navigate"&&Y(()=>c[3][1](c[0]))):(s.set(u,c=[l,p,i,A(l)]),c[3].count=0),d&&(c[3].count++,c[3][0]()),w){const h=_();if(h&&h.router.dataOnly)return h.router.data[u]=p}if(i!=="preload"&&(p="then"in p?p.then(y(!1),y(!0)):y(!1)(p)),w&&$.context&&$.context.async&&!$.context.noHydrate){const h=_();(!h||!h.serverOnly)&&$.context.serialize(u,p)}return p;function y(h){return async f=>{if(f instanceof Response){if(f.headers.has("Location")){o&&Y(()=>{let v=f.headers.get(gi);v&&v.startsWith("/")?o(v,{replace:!0}):!w&&v&&(window.location.href=v)});return}f.customBody&&(f=await f.customBody())}if(h)throw f;return f}}};return r.keyFor=(...n)=>t+Ve(n),r.key=t,r}ae.set=(e,t)=>{const r=tt(),n=Date.now();let s=r.get(e);s?(s[0]=n,s[1]=t,s[2]="preload"):(r.set(e,s=[n,t,,A(n)]),s[3].count=0)};ae.clear=()=>tt().clear();function bi(e,t){for(let r of t)if(e.startsWith(r))return!0;return!1}function Ve(e){return JSON.stringify(e,(t,r)=>wi(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function wi(e){let t;return e!=null&&typeof e=="object"&&(!(t=Object.getPrototypeOf(e))||t===Object.prototype)}const Ue=new Map;function Si(e,t){function r(...s){const i=this,a=(i.singleFlight&&e.withOptions?e.withOptions({headers:{"X-Single-Flight":"true"}}):e)(...s),[o,l]=A();let u;async function c(d){const p=await Ei(d,i.navigatorFactory());return p?l({data:p}):u.clear(),p}return i.submissions[1](d=>[...d,u={input:s,url:n,get result(){return o()?.data},get pending(){return!o()},clear(){i.submissions[1](p=>p.filter(y=>y.input!==s))},retry(){return l(void 0),e(...s).then(c,c)}}]),a.then(c,c)}const n=e.url||t&&`https://action/${t}`||(w?"":`https://action/${zi(e.toString())}`);return or(r,n)}function or(e,t){return e.toString=()=>{if(!t)throw new Error("Client Actions need explicit names if server rendered");return t},e.with=function(...r){const n=function(...i){return e.call(this,...r,...i)},s=new URL(t,Qe);return s.searchParams.set("args",Ve(r)),or(n,(s.origin==="https://action"?s.origin:"")+s.pathname+s.search)},e.url=t,w||(Ue.set(t,e),re()&&V(()=>Ue.delete(t))),e}const zi=e=>e.split("").reduce((t,r)=>(t<<5)-t+r.charCodeAt(0)|0,0);async function Ei(e,t){let r,n,s;if(e instanceof Response){if(e.headers.has("X-Revalidate")&&(n=s=e.headers.get("X-Revalidate").split(",")),e.customBody&&(r=await e.customBody(),e.headers.has("X-Single-Flight")&&(n||(n=[]),s||(s=[]),Object.keys(r).forEach(i=>{i!=="_$value"&&(n.push(i),ae.set(i,r[i]))}),r=r._$value)),e.headers.has("Location")){const i=e.headers.get("Location")||"/";i.startsWith("http")?window.location.href=i:t(i)}}else r=e;return ar(s,i=>i[0]=0),await Me(n,!1),r}function Ri(e=!0,t=!1,r="/_server"){return n=>{const s=n.base.path(),i=n.navigatorFactory(n.base);let a={};function o(h){return h.namespaceURI==="http://www.w3.org/2000/svg"}function l(h){if(h.defaultPrevented||h.button!==0||h.metaKey||h.altKey||h.ctrlKey||h.shiftKey)return;const f=h.composedPath().find(H=>H instanceof Node&&H.nodeName.toUpperCase()==="A");if(!f||t&&!f.hasAttribute("link"))return;const v=o(f),S=v?f.href.baseVal:f.href;if((v?f.target.baseVal:f.target)||!S&&!f.hasAttribute("state"))return;const P=(f.getAttribute("rel")||"").split(/\s+/);if(f.hasAttribute("download")||P&&P.includes("external"))return;const N=v?new URL(S,document.baseURI):new URL(S);if(!(N.origin!==window.location.origin||s&&N.pathname&&!N.pathname.toLowerCase().startsWith(s.toLowerCase())))return[f,N]}function u(h){const f=l(h);if(!f)return;const[v,S]=f,ce=n.parsePath(S.pathname+S.search+S.hash),P=v.getAttribute("state");h.preventDefault(),i(ce,{resolve:!1,replace:v.hasAttribute("replace"),scroll:!v.hasAttribute("noscroll"),state:P&&JSON.parse(P)})}function c(h){const f=l(h);if(!f)return;const[v,S]=f;a[S.pathname]||n.preloadRoute(S,v.getAttribute("preload")!=="false")}function d(h){const f=l(h);if(!f)return;const[v,S]=f;a[S.pathname]||(a[S.pathname]=setTimeout(()=>{n.preloadRoute(S,v.getAttribute("preload")!=="false"),delete a[S.pathname]},200))}function p(h){const f=l(h);if(!f)return;const[,v]=f;a[v.pathname]&&(clearTimeout(a[v.pathname]),delete a[v.pathname])}function y(h){let f=h.submitter&&h.submitter.hasAttribute("formaction")?h.submitter.getAttribute("formaction"):h.target.getAttribute("action");if(!f)return;if(!f.startsWith("https://action/")){const S=new URL(f,Qe);if(f=n.parsePath(S.pathname+S.search),!f.startsWith(r))return}if(h.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const v=Ue.get(f);if(v){h.preventDefault();const S=new FormData(h.target);h.submitter&&h.submitter.name&&S.append(h.submitter.name,h.submitter.value),v.call(n,S)}}Or(["click","submit"]),document.addEventListener("click",u),e&&(document.addEventListener("mouseover",d),document.addEventListener("mouseout",p),document.addEventListener("focusin",c),document.addEventListener("touchstart",c)),document.addEventListener("submit",y),V(()=>{document.removeEventListener("click",u),e&&(document.removeEventListener("mouseover",d),document.removeEventListener("mouseout",p),document.removeEventListener("focusin",c),document.removeEventListener("touchstart",c)),document.removeEventListener("submit",y)})}}function Ii(e){if(w)return mi(e);const t=()=>({value:window.location.pathname+window.location.search+window.location.hash,state:window.history.state}),r=Zt();return di({get:t,set({value:n,replace:s,scroll:i,state:a}){s?window.history.replaceState(Vs(a),"",n):window.history.pushState(a,"",n),fi(window.location.hash.slice(1),i),Ze()},init:n=>hi(window,"popstate",Us(n,s=>{if(s&&s<0)return!r.confirm(s);{const i=t();return!r.confirm(i.value,{state:i.state})}})),create:Ri(e.preload,e.explicitLinks,e.actionBase),utils:{go:n=>window.history.go(n),beforeLeave:r}})(e)}function lr(e,t){let r,n=()=>!r||r.state==="unresolved"?void 0:r.latest;return[r]=Pr(()=>Ai(e,me(n)),s=>s,t),()=>r()}class x{static all(){return new x}static allSettled(){return new x}static any(){return new x}static race(){return new x}static reject(){return new x}static resolve(){return new x}catch(){return new x}then(){return new x}finally(){return new x}}function Ai(e,t){if(w||!$.context)return e(t);const r=fetch,n=Promise;try{return window.fetch=()=>new x,Promise=x,e(t)}finally{window.fetch=r,Promise=n}}function gt(e,t=302){let r,n;typeof t=="number"?r={status:t}:({revalidate:n,...r}=t,typeof r.status>"u"&&(r.status=302));const s=new Headers(r.headers);return s.set("Location",e),n&&s.set("X-Revalidate",n.toString()),new Response(null,{...r,headers:s})}const cr=be(),ur=["title","meta"],Be=[],qe=["name","http-equiv","content","charset","media"].concat(["property"]),ye=(e,t)=>{const r=Object.fromEntries(Object.entries(e.props).filter(([n])=>t.includes(n)).sort());return(Object.hasOwn(r,"name")||Object.hasOwn(r,"property"))&&(r.name=r.name||r.property,delete r.property),e.tag+JSON.stringify(r)};function xi(){if(!$.context){const r=document.head.querySelectorAll("[data-sm]");Array.prototype.forEach.call(r,n=>n.parentNode.removeChild(n))}const e=new Map;function t(r){if(r.ref)return r.ref;let n=document.querySelector(`[data-sm="${r.id}"]`);return n?(n.tagName.toLowerCase()!==r.tag&&(n.parentNode&&n.parentNode.removeChild(n),n=document.createElement(r.tag)),n.removeAttribute("data-sm")):n=document.createElement(r.tag),n}return{addTag(r){if(ur.indexOf(r.tag)!==-1){const i=r.tag==="title"?Be:qe,a=ye(r,i);e.has(a)||e.set(a,[]);let o=e.get(a),l=o.length;o=[...o,r],e.set(a,o);let u=t(r);r.ref=u,it(u,r.props);let c=null;for(var n=l-1;n>=0;n--)if(o[n]!=null){c=o[n];break}return u.parentNode!=document.head&&document.head.appendChild(u),c&&c.ref&&document.head.removeChild(c.ref),l}let s=t(r);return r.ref=s,it(s,r.props),s.parentNode!=document.head&&document.head.appendChild(s),-1},removeTag(r,n){const s=r.tag==="title"?Be:qe,i=ye(r,s);if(r.ref){const a=e.get(i);if(a){if(r.ref.parentNode){r.ref.parentNode.removeChild(r.ref);for(let o=n-1;o>=0;o--)a[o]!=null&&document.head.appendChild(a[o].ref)}a[n]=null,e.set(i,a)}else r.ref.parentNode&&r.ref.parentNode.removeChild(r.ref)}}}}function Pi(){const e=[];return Fr(()=>E(Fi(e))),{addTag(t){if(ur.indexOf(t.tag)!==-1){const r=t.tag==="title"?Be:qe,n=ye(t,r),s=e.findIndex(i=>i.tag===t.tag&&ye(i,r)===n);s!==-1&&e.splice(s,1)}return e.push(t),e.length},removeTag(t,r){}}}const $i=e=>{const t=w?Pi():xi();return g(cr.Provider,{value:t,get children(){return e.children}})},ki=(e,t,r)=>(Oi({tag:e,props:t,setting:r,id:He(),get name(){return t.name||t.property}}),null);function Oi(e){const t=ne(cr);if(!t)throw new Error("<MetaProvider /> should be in the tree");Rt(()=>{const r=t.addTag(e);V(()=>t.removeTag(e,r))})}function Fi(e){return e.map(t=>{const n=Object.keys(t.props).map(i=>i==="children"?"":` ${i}="${m(t.props[i],!0)}"`).join(""),s=t.props.children;return t.setting?.close?`<${t.tag} data-sm="${t.id}"${n}>${t.setting?.escape?m(s):s||""}</${t.tag}>`:`<${t.tag} data-sm="${t.id}"${n}/>`}).join("")}const oe=e=>ki("title",e,{escape:!0,close:!0});function Ti(e){const t="/notes/";let r=e.indexOf(t);if(r<0)return"";r+=t.length;const n=e.indexOf("/",r);return n<0?e.slice(r):e.slice(r,n)}const dr="/",Ci="/new",hr=e=>`/notes/${e}`,_i=e=>`/notes/${e}/edit`,Ni=e=>e.search?e.pathname+e.search:e.pathname,ji=e=>new URL(e,"thismessage:/").search??"",vt=(e="")=>dr+e,Li=(e,t="")=>hr(e)+t;function Di(e){const t=Ti(location.pathname);if(t.length<1)throw new Error("Pathname was expected to contain a note ID");return _i(t)+(e.search??"")}const Mi=e=>dr+(e.search??""),Vi=e=>Ci+(e.search??"");function Ui(e,t){const r=hr(t),n=e.search??"";return{pathname:r,search:n,href:r+n}}const yt="SolidStart Notes",le=e=>e?`${e} - ${yt}`:yt;var Bi=["<button",">","</button>"];const qi=e=>"c-edit-button"+(e==="new"?" js:c-edit-button--new":" js:c-edit-button--update");function fr(e){return Re(),ie(),e.kind,E(Bi,I()+z("class",m(qi(e.kind),!0),!1),m(e.children))}const Wi=(e,t)=>{if(w)return Object.assign(()=>{},{clear:()=>{}});let r;const n=()=>clearTimeout(r);return re()&&V(n),Object.assign((...i)=>{r!==void 0&&n(),r=setTimeout(()=>e(...i),t)},{clear:n})};var Hi=["<div",' role="progressbar"',"></div>"];function Ki(e){return E(Hi,I()+z("class","c-spinner"+(e.active?" c-spinner--active":""),!1),z("aria-busy",m(e.active,!0),!1))}var Xi=["<form",' class="c-search-field" role="search"><label class="u-offscreen"',">Search for a note by title</label><input",' placeholder="Search"',"><!--$-->","<!--/--></form>"];function Gi(e){const t=Wi(e,250);return r=>{t({search:r.currentTarget.value}),r.preventDefault()}}function Ji(){const e=He(),t=Zs(),[r,n]=rr();return Gi(n),E(Xi,I(),z("for",m(e,!0),!1),z("id",m(e,!0),!1),z("value",m(r.search,!0)??"",!1),m(g(Ki,{get active(){return t()}})))}const Yi=["insert","update","delete"],Zi=e=>Yi.includes(e),Qi="edit-action",We="briefs",ea="note",ta=ae(async e=>Nr(e),We),ra=ae(async e=>jr(e),ea),na=Si(async e=>{const t=e.get("intent");if(typeof t!="string"||!Zi(t))throw new Error(`Malformed edit-action. "intent" param: :${t}`);const r=e.get("from");if(typeof r!="string"||r.length<1)throw new Error(`Malformed edit-action. "from" param: :${r}`);const n=ji(r),s=e.get("id")??"",i=e.get("title")??"",a=e.get("body")??"";if(typeof s!="string"||typeof i!="string"||typeof a!="string")throw new Error("Malformed edit-action. note params");const o=s.length>0?s:void 0;if(t==="insert"||t==="update"){const l=await Lr(i,a,o),u=l?Li(l.id,n):vt(n);throw Me(We,!0),gt(u)}if(t==="delete")throw o?(await Dr(o),Me(We,!0),gt(vt(n))):new Error("edit-action: cannot delete without ID")},Qi),pr={locale:"en-GB",timeZone:"UTC",numberingSystem:"latn",calendar:"gregory",hour12:!1};function bt({locale:e,timeZone:t,hour12:r}=pr){const n=Intl.DateTimeFormat(e,{timeZone:t,hour12:r,dateStyle:"medium",timeStyle:"short"});return function(a){const o=new Date(a);return[n.format(o),o.toISOString()]}}function wt({locale:e,timeZone:t,hour12:r}=pr){const n=Intl.DateTimeFormat(e,{timeZone:t,hour12:r,dateStyle:"short"}),s=Intl.DateTimeFormat(e,{timeZone:t,hour12:r,timeStyle:"short"});let i=new Date;return function(l,u=!1){u&&(i=new Date);const c=new Date(l);return[c.getDate()===i.getDate()&&c.getMonth()===i.getMonth()&&c.getFullYear()===i.getFullYear()?s.format(c):n.format(c),c.toISOString()]}}function mr(e,t){if(!(t instanceof HTMLElement))throw new Error("Unsuitable ancestor element");const r=t.querySelector("time");if(!(r instanceof HTMLTimeElement))throw new Error("Unable to locate time element under specified ancestor");const n=r.textContent;if(!n)return;const s=Date.parse(r.dateTime),[i]=e(s);n!==i&&(r.textContent=i)}var sa=["<time",">","</time>"],ia=["<div","><header><strong>","</strong><!--$-->","<!--/--></header><input",' type="checkbox" class="c-brief__summary-state"><button',">Open note for preview</button><label",' class="c-brief__summary-toggle"><svg viewBox="0 0 512 512" aria-hidden="true" fill="currentColor" width="1em" height="1em"><path d="M60 99.333l196 196 196-196 60 60-256 256-256-256z"></path></svg></label><p class="c-brief__summary">',"</p></div>"],aa=["<span",' class="c-brief__no-content">(No Content)</span>'];const oa=" js:c-brief--flash",la=[""," c-brief--pending"," c-brief--active"],ca=e=>"js:c-brief c-brief "+(e?oa:""),ua=e=>"js:c-brief__open c-brief__open"+la[e];function da(e){let t;const r=He(),[n,s]=e.format(e.updatedAt);return Ke(()=>{mr(e.format,t)}),E(ia,I()+z("class",m(ca(e.flushed),!0),!1)+z("data-note-id",m(e.noteId,!0),!1),m(e.title),m(g(xt,{get children(){return E(sa,I()+z("datetime",m(s,!0),!1),m(n))}})),z("id",m(r,!0),!1),z("class",m(ua(e.active),!0),!1),z("for",m(r,!0),!1),m(g(W,{get when(){return e.summary},get fallback(){return E(aa,I())},get children(){return e.summary}})))}const[ha,fa]=A(void 0,{equals:!1}),pa={lastEdit:ha,sendLastEdit:fa},ma=be(pa);function gr(){const e=ne(ma);if(!e)throw new Error("AppContext not initialized");return e}const ga=gr,va=gr;var ya=["<div",' class="c-brief-empty"><!--$-->',"<!--/--> </div>"],ba=["<ul",' class="c-brief-list">',"</ul>"],wa=["<nav",">","</nav>"],Sa=["<li",">","</li>"];const za=e=>E(ya,I(),e.search?`Couldn't find any notes titled "${m(e.search)}"`:"No notes created yet!");function Ea(e){if(!(e instanceof HTMLButtonElement&&e.classList.contains("js:c-brief__open")))return;const t=e.closest("div.js\\:c-brief");return t instanceof HTMLDivElement?t.dataset.noteId:void 0}function Ra(){return w?wt():wt(Intl.DateTimeFormat().resolvedOptions())}function Ia(e){const[t,r]=qr([]);return[async function(){const s=await ta(e());return r(Wr(s)),t},{initialValue:t}]}function Aa(e,t){const r="";return()=>{const n=t();switch(n?.[0]){case void 0:case"delete":return r;case"update":return n[1];case"new":{const s=e();return typeof s=="string"&&s.length>0?s:r}default:return r}}}const xa=([e,t],r)=>e===r?t:0;function Pa(e){const t=Qs(),r=()=>t.noteId??"",n=Re(),[s,i]=A({noteId:r(),pathname:n.pathname}),a=k(()=>{const h=s();if(n.pathname!==h.pathname&&h.noteId.length>0)return[h.noteId,1];const f=r();return f.length>0?[f,2]:["",0]}),o=ie(),l=h=>{const f=Ea(h.target);if(!f)return;const v=Ui(n,f);i({noteId:f,pathname:v.pathname}),o(v.href)},{lastEdit:u}=ga(),c=k(Aa(r,u)),d=lr(...Ia(()=>e.searchText)),p=Ra();let y;return Ke(()=>{y instanceof HTMLElement&&y.addEventListener("click",l)}),E(wa,I(),m(g(W,{get when(){return d().length},get fallback(){return g(za,{get search(){return e.searchText}})},get children(){return E(ba,I(),m(g($r,{get each(){return d()},children:h=>E(Sa,I(),m(g(da,{get noteId(){return h.id},get title(){return h.title},get summary(){return h.summary},get updatedAt(){return h.updatedAt},get active(){return xa(a(),h.id)},get flushed(){return c()===h.id},format:p})))})))}})))}var $a=["<div",' class="c-note-preview"><div class="o-from-markdown">',"</div></div>"];const ka=w?globalThis.ssrSupport.mdToHtml:e=>"client";console.log("YYY",globalThis.ssrSupport,w);const vr=e=>E($a,I(),e.body?ka(e.body):"");var Oa=["<button",' class="c-note-edit__delete" role="menuitem"','><img src="/cross.svg" width="10px" height="10px" alt="" role="presentation">Delete</button>'],Fa=["<div",' class="c-note-edit"><form class="c-note-edit__form" method="post"','><input type="hidden" name="id"','><input type="hidden" name="from"','><input type="hidden" name="intent"','><label class="u-offscreen" for="note-edit__title">Enter a title for your note</label><input id="note-edit__title" type="text" name="title"','><label class="u-offscreen" for="note-edit__body">Enter the body for your note</label><textarea id="note-edit__body" name="body"','></textarea></form><div class="c-note-edit__preview"><div class="c-note-edit__menu" role="menubar"><button class="c-note-edit__done" role="menuitem"','><img src="/checkmark.svg" width="14px" height="10px" alt="" role="presentation">Done</button><!--$-->','<!--/--></div><div class="c-note-edit__label-preview" role="status">Preview</div><h1 class="c-note-edit__note-title">',"</h1><!--$-->","<!--/--></div></div>"];const Ta=e=>typeof e=="string"&&e.length>0?e:void 0;function yr(e){const t=()=>!!Ta(e.noteId),[r,n]=A(t()?"update":"insert"),[s,i]=A(!1),[a,o]=A(e.initialTitle),l=()=>{const h=a();return h!==void 0?h:e.initialTitle??""},[u,c]=A(e.initialBody),d=()=>{const h=u();return h!==void 0?h:e.initialBody??""},p=Re(),{sendLastEdit:y}=va();return y(void 0),E(Fa,I(),z("action",m(na,!0),!1),z("value",m(e.noteId,!0)??"",!1),z("value",m(Ni(p),!0),!1),z("value",m(r(),!0),!1),z("value",m(l(),!0),!1),z("value",m(d(),!0),!1),z("disabled",s(),!0),m(g(W,{get when(){return t()},get children(){return E(Oa,I(),z("disabled",s(),!0))}})),m(l()),m(g(vr,{get body(){return d()}})))}var Ca=["<time",">","</time>"],_a=["<div",' class="c-note"><div class="c-note__header"><h1>','</h1><div class="c-note__menu" role="menubar"><small class="c-note__updated" role="status">Last updated on <!--$-->',"<!--/--></small><!--$-->","<!--/--></div></div><!--$-->","<!--/--></div>"];const br=w?bt():bt(Intl.DateTimeFormat().resolvedOptions());function Na(e,t){const r=({id:n,title:s,body:i,updatedAt:a})=>{const[o,l]=br(a);return{id:n,title:s,body:i,updatedAt:a,updatedISO:l,updated:o}};return function(s){if(s)return r(s);t(Mi(e),{replace:!0})}}function ja(e){const t=(n,s="")=>e.note?.[n]??s;let r;return Ke(()=>{mr(br,r)}),[g(oe,{get children(){return le(e.noteId)}}),E(_a,I(),m(t("title")),m(g(xt,{get children(){return E(Ca,I()+z("datetime",m(t("updatedISO"),!0),!1),m(t("updated")))}})),m(g(fr,{kind:"update",children:"Edit"})),m(g(vr,{get body(){return t("body")}})))]}function St(e){const t=()=>e.edit,r=()=>e.params.noteId,n=ie(),s=Na(e.location,n),i=lr(()=>ra(r()).then(s),{deferStream:!0});return[g(oe,{get children(){return le(t()?`Edit ${r()}`:r())}}),g(W,{get when(){return t()},get fallback(){return g(ja,{get noteId(){return r()},get note(){return i()}})},get children(){return g(yr,{get noteId(){return r()},get initialTitle(){return i()?.title},get initialBody(){return i()?.body}})}})]}function La(){return[g(oe,{get children(){return le("New Note")}}),g(yr,{noteId:void 0,initialTitle:"Untitled",initialBody:""})]}var Da=["<div",' class="c-note-none"><span>Click a note on the left to view something! </span></div>'];function Ma(){return[g(oe,{get children(){return le()}}),E(Da,I())]}function Va(e){if(w){const t=_();t.response.status=e.code,t.response.statusText=e.text,V(()=>!t.nativeEvent.handled&&(t.response.status=200))}return null}var Ua=["<div",' class="c-not-found"><!--$-->',"<!--/--><!--$-->",'<!--/--><h1>Page Not Found</h1><p class="c-info-learn">Visit <a href="https://start.solidjs.com" target="_blank">start.solidjs.com</a> to learn how to build SolidStart apps.</p></div>'];function Ba(){return E(Ua,I(),m(g(oe,{get children(){return le("Not Found")}})),m(g(Va,{code:404})))}var qa=["<main",' class="c-main"><section class="c-sidebar c-main__column"><section class="c-sidebar__header"><img class="c-logo" src="/logo.svg" width="22px" height="20px" alt="" role="presentation"><strong>Solid Notes</strong></section><section class="c-sidebar__menu" role="menubar"><!--$-->',"<!--/--><!--$-->","<!--/--></section><!--$-->",'<!--/--></section><section class="c-note-view c-main__column">',"</section></main>"];function Wa(e){const[t]=rr();return g($i,{get children(){return E(qa,I(),m(g(Ji,{})),m(g(fr,{kind:"new",children:"New"})),m(g(st,{get children(){return g(Pa,{get searchText(){return t.search}})}})),m(g(st,{get children(){return e.children}})))}})}function Ha(){const e=r=>St(Te({edit:!0},r)),t=r=>St(Te({edit:!1},r));return g(Ii,{root:Wa,get children(){return[g(X,{path:"/new",component:La}),g(X,{path:"/notes/:noteId/edit",component:e}),g(X,{path:"/notes/:noteId",component:t}),g(X,{path:"/",component:Ma}),g(X,{path:"*404",component:Ba})]}})}function Ka(e){const r=e.length.toString(16),n="00000000".substring(0,8-r.length)+r;return new TextEncoder().encode(`;0x${n};${e}`)}function Xa(e,t){return new ReadableStream({start(r){cs(t,{scopeId:e,plugins:[Ut,Bt,qt,Wt,we,Se,Ht,Kt,Xt,Gt],onSerialize(n,s){r.enqueue(Ka(s?`(${Jr(e)},${n})`:n))},onDone(){r.close()},onError(n){r.error(n)}})}})}async function Ga(e){const t=Mr(e),r=t.request,n=r.headers.get("X-Server-Id"),s=r.headers.get("X-Server-Instance"),i=r.headers.has("X-Single-Flight"),a=new URL(r.url);let o,l;if(n)Is(typeof n=="string","Invalid server function"),[o,l]=n.split("#");else if(o=a.searchParams.get("id"),l=a.searchParams.get("name"),!o||!l)throw new Error("Invalid request");const u=(await globalThis.MANIFEST["server-fns"].chunks[o].import())[l];let c=[];if(!s||e.method==="GET"){const d=a.searchParams.get("args");d&&JSON.parse(d).forEach(p=>c.push(p))}if(e.method==="POST"){const d=r.headers.get("content-type");if(d?.startsWith("multipart/form-data")||d?.startsWith("application/x-www-form-urlencoded"))c.push(await new Request(r,{...r,body:e.node.req.body}).formData());else if(d?.startsWith("application/json")){const p=new Request(r,{...r,body:e.node.req.body});c=is(await p.json(),{plugins:[Ut,Bt,qt,Wt,we,Se,Ht,Kt,Xt,Gt]})}}try{let d=await Pt(t,async()=>($.context={event:t},u(...c)));if(i&&s&&(d=await Ja(t,d)),d instanceof Response&&s&&(d.headers&&at(e,d.headers),d.customBody?d=await d.customBody():d.body==null&&(d=null)),!s){const p=d instanceof Error,y=new URL(r.headers.get("referer"));return new Response(null,{status:302,headers:{Location:y.toString(),...d?{"Set-Cookie":`flash=${JSON.stringify({url:a.pathname+encodeURIComponent(a.search),result:p?d.message:d,error:p,input:[...c.slice(0,-1),[...c[c.length-1].entries()]]})}; Secure; HttpOnly;`}:{}}})}return Vr(e,"content-type","text/javascript"),Xa(s,d)}catch(d){return d instanceof Response&&(d.status===302&&!s&&Ur(e,302),d.headers&&at(e,d.headers),d.customBody?d=d.customBody():d.body==null&&(d=null)),d}}async function Ja(e,t){let r,n=new URL(e.request.headers.get("referer")).toString();t instanceof Response&&(t.headers.has("X-Revalidate")&&(r=t.headers.get("X-Revalidate").split(",")),t.headers.has("Location")&&(n=new URL(t.headers.get("Location"),new URL(e.request.url).origin+"").toString()));const s=Br(e);return s.request=new Request(n),await Pt(s,async()=>{await Ms(s),s.router.dataOnly=r||!0,s.router.previousUrl=e.request.headers.get("referer");try{Tr(()=>{$.context.event=s,Ha()})}catch(o){console.log(o)}const i=s.router.data;if(!i)return t;let a=!1;for(const o in i)i[o]===void 0?delete i[o]:a=!0;return a&&(t instanceof Response?t.customBody&&(i._$value=t.customBody()):(i._$value=t,t=new Response(null,{status:200})),t.customBody=()=>i,t.headers.set("X-Single-Flight","true")),t})}const Eo=Hr(Ga);export{Eo as default};
