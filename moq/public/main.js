!function(){"use strict";const e=document.getElementById("note-data");if(!(e instanceof HTMLScriptElement))throw new Error('Unable to locate "note-data" JSON content.');const t=JSON.parse(e.text);!Array.isArray(t)||t.length<1||(t[0].updatedAt=Date.now()-72e5);const n=t.reduce(((e,t)=>e.set(t.id,t)),new Map);const o="SolidStart Notes",i=e=>e?`${e} - ${o}`:o;function r(e){throw new Error(`Invalid path "${e}"`)}function c(e,t){const n=e.querySelector(`#${t}`);if(!(n instanceof HTMLTemplateElement))throw new Error(`Can't find template for ID "${t}"`);const o=n.content.firstElementChild;if(!(o instanceof HTMLElement))throw new Error(`Invalid root for template ID "${t}"`);return o}function d(e){document.addEventListener("moq-busy",(t=>e(t.detail)))}const s=e=>document.dispatchEvent(new CustomEvent("moq-busy",{detail:e}));const l={locale:"en-GB",timeZone:"UTC",numberingSystem:"latn",calendar:"gregory",hour12:!1};const a="Untitled",u="";const f=function({locale:e,timeZone:t,hour12:n}=l){const o=Intl.DateTimeFormat(e,{timeZone:t,hour12:n,dateStyle:"medium",timeStyle:"short"});return function(e){const t=new Date(e);return[o.format(t),t.toISOString()]}}(Intl.DateTimeFormat().resolvedOptions());const m="js:c-brief--flash",p=e=>!(1&~e),h=e=>2===e,E=e=>3===e;const y=function({locale:e,timeZone:t,hour12:n}=l){const o=Intl.DateTimeFormat(e,{timeZone:t,hour12:n,dateStyle:"short"}),i=Intl.DateTimeFormat(e,{timeZone:t,hour12:n,timeStyle:"short"});let r=new Date;return function(e,t=!1){t&&(r=new Date);const n=new Date(e);return[n.getDate()===r.getDate()&&n.getMonth()===r.getMonth()&&n.getFullYear()===r.getFullYear()?i.format(n):o.format(n),n.toISOString()]}}(Intl.DateTimeFormat().resolvedOptions());const T=function(e){const t=c(e,"app");return function({briefList:e,newButton:n,note:o,searchField:i}){const r=t.cloneNode(!0),c=r.querySelector(".c-sidebar__menu");if(!c)throw new Error('Failed to find ".c-sidebar__menu" in "app" content');c.append(i),c.append(n),c.insertAdjacentElement("afterend",e);const d=r.querySelector(".c-note-view");if(!d)throw new Error('Failed to find "c-note-view" in "app" content');return d.append(o),r}}(document),g=function(e){const t=c(e,"edit-button");return function(n,o){const i=t.cloneNode(!0),r=e.createTextNode(n);return i.appendChild(r),i.classList.add("new"===o?"js:c-edit-button--new":"js:c-edit-button--update"),i instanceof HTMLButtonElement&&d((e=>i.disabled=e)),i}}(document),w=function(e,t){const n=c(e,"note"),o=c(e,"note-none"),i=function(e){const t=c(e,"note-preview");return function(e){const n=t.cloneNode(!0),o=n.querySelector(".o-from-markdown");return o instanceof HTMLElement&&(o.innerHTML=e),n}}(e),r=function(e,t){const n=c(e,"note-edit");return function(o){const i=n.cloneNode(!0),r=i.querySelector("#note-edit__title");r instanceof HTMLInputElement&&(r.value=o?o.title:a);const c=i.querySelector(".c-note-edit__note-title");c instanceof HTMLElement&&(c.append(e.createTextNode(o?o.title:a)),c.insertAdjacentElement("afterend",t(o?o.html:u)));const s=i.querySelector(".c-note-edit__delete"),l=i.querySelector(".c-note-edit__done");if(o){const e=i.querySelector("#note-edit__body");e instanceof HTMLTextAreaElement&&(e.textContent=o.body)}return l instanceof HTMLButtonElement&&s instanceof HTMLButtonElement&&(o||s.remove(),d(o?e=>{l.disabled=s.disabled=e}:e=>{l.disabled=e})),i}}(e,i);return function(c,d){if(d)return r(c);if(!c)return o.cloneNode(!0);const s=n.cloneNode(!0),l=s.querySelector("h1");l instanceof HTMLElement&&l.appendChild(e.createTextNode(c.title));const a=s.querySelector(".c-note__menu");if(a instanceof HTMLElement){const n=s.querySelector("time");if(n instanceof HTMLTimeElement){const[t,o]=f(c.updatedAt);n.dateTime=o,n.appendChild(e.createTextNode(t))}a.append(t("Edit","edit"))}return s.append(i(c.html)),s}}(document,g),L=function(e){const t=function(e){const t=c(e,"brief");return function(n,o=0){const i=t.cloneNode(!0);i.dataset.noteId=n.id;const r=i.querySelector("header");if(r instanceof HTMLElement){const u=r.querySelector("strong");u instanceof HTMLElement&&u.appendChild(e.createTextNode(n.title));const f=r.querySelector("time");if(f instanceof HTMLTimeElement){const[T,g]=y(n.updatedAt);f.dateTime=g,f.appendChild(e.createTextNode(T))}}const c=i.querySelector(".c-brief__summary");c instanceof HTMLElement&&n.excerpt&&c.replaceChildren(e.createTextNode(n.excerpt));const d=i.querySelector("input"),l=i.querySelector("label");d instanceof HTMLInputElement&&l instanceof HTMLLabelElement&&(d.id=d.id+n.id,l.htmlFor=d.id);const a=i.querySelector(".c-brief__open");if(a instanceof HTMLButtonElement){const w=h(o)?"c-brief--pending":p(o)?"c-brief--active":void 0;w&&a.classList.add(w)}if(E(o)){function L(){i.classList.add(m),s(!0)}function S(e){if("flash"===e.animationName)return i.classList.remove(m),s(!1),void setTimeout(L,3e3)}i.addEventListener("animationend",S),L()}return i}}(e),n=c(e,"brief-list__empty"),[o,i]=function(e,t){const n=c(e,t),o=n.querySelector("li");if(!(o instanceof HTMLLIElement))throw new Error(`Template ID "${t}" does not contain list item`);return o.remove(),[n,o]}(e,"brief-list");return function(r,c,d,s=!1){const l=o.cloneNode(!0),[a,u]="string"==typeof r?[void 0,r.length>0?r:void 0]:[Array.isArray(r)&&r.length>0?r:void 0,void 0];if(!a){const t=n.cloneNode(!0);return t.appendChild(e.createTextNode(u?`Couldn't find any notes titled "${u}"`:"No notes created yet!")),l.replaceChildren(t),l}const f=l.firstElementChild;if(f){const e=function(e,t,n){if(e){const o=t?3:1;return n?t=>n===t?2:e===t?o:0:t=>t===e?o:0}return n?e=>e===n?2:0:e=>0}(c,s,d);for(const n of a){const o=i.cloneNode(!0);o.append(t(n,e(n.id))),f.append(o)}}return l}}(document),S=function(e){const t=c(e,"search-field");return function(e,n=!1){const o=t.cloneNode(!0);if(e){const t=o.querySelector("#search-field__search");if(!(t instanceof HTMLInputElement))throw new Error('Failed to find "#search-field__search" input in "search-field" content');t.value=e}const i=o.querySelector(".c-spinner");return i instanceof HTMLElement&&n&&(i.classList.add("c-spinner--active"),i.setAttribute("aria-busy","true")),o}}(document);const v=function(e){const{isEditing:t,noteId:n,title:o}=function(e){const t=e.split("/");if(2===t.length&&0===t[1].length)return{noteId:void 0,isEditing:!1,title:i()};if(t.length>2&&"note"===t[1]){if(3===t.length&&"new"===t[2])return{noteId:void 0,isEditing:!0,title:i("New Note")};if(t.length<5&&t[2].length>0){if(3===t.length)return{noteId:t[2],isEditing:!1,title:i(t[2])};if("edit"===t[3])return{noteId:t[2],isEditing:!0,title:i(`Edit ${t[2]}`)};r(e)}r(e)}r(e)}(e.pathname),c=e.searchParams,d=c.get("search")??void 0,s=c.get("moqnextid")??void 0;return{flushNote:c.has("moqflush"),isEditing:t,nextId:s&&s.length>0?s:void 0,noteId:n,search:"string"==typeof d&&d.length>0?d:void 0,title:o}}(new URL(document.location.href));document.title=v.title;document.querySelector("body").prepend(function({flushNote:e,isEditing:o,nextId:i,noteId:r,search:c}){const d=function(e){if(!e)return t;const n=e.toLowerCase();return t.filter((e=>e.title.toLowerCase().includes(n)))}(c),s=d.length>0?d:c,l=r?(a=r,n.get(a)):void 0;var a;const u=Boolean(i);return T({briefList:L(s,l?.id,i,e),newButton:g("New","new"),note:w(l,o),searchField:S(c,u)})}(v))}();
